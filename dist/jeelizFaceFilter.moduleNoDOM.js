 /**
 * Jeeliz Face Filter - https://github.com/jeeliz/jeelizFaceFilter
 *
 * Copyright 2020 WebAR.rocks ( https://webar.rocks )
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*/

// BEGIN EMULATE DOM

// import some usefull stuffs
try {
  var Buffer = require('buffer').Buffer;
} catch(err) {
  console.log('Cannot import Buffer package');
}

// emulate global variables:
const navigator = {  
  platform: "Linux x86_64",
  userAgent: "forceWebGL1_noAntialiasing_noDOM"
};

const window = {
  canvas: null,
  innnerWidth: -1,
  innerHeight: -1,
  URL: {
    createObjectURL: function() {
      return null
    }
  },
  addEventListener: function() {},
  removeEventListener: function() {},
  requestAnimationFrame: function(step) {
    if (window.canvas === null){
      setTimeout(step, 1);
      return;
    }
    window.canvas.requestAnimationFrame(step)
  },
  cancelAnimationFrame: function(step) {
    if (window.canvas === null){
      return;
    }
    window.canvas.cancelAnimationFrame(step)
  },
  setCanvas: function(c) {
    window.canvas = c;
  }
};

const document = {
  createElement: function(elementType){
    switch(elementType){
      case 'canvas':
        return null; // return a real canvas
    }
  },
  getElementById: function(elementId){
    return null;
  },
  body: { appendChild: function(element){ return null; }}
};

if(typeof(wx) !== 'undefined'){ //WECHAT
  const systemInfo = wx.getSystemInfoSync()
  window.innnerWidth = systemInfo.windowWidth;
  window.innnerHeight = systemInfo.windowHeight;
}

const FAKEDOM = {
  window: window,
  document: document,
  navigator: navigator
};
// END EMULATE DOM


window.JEELIZFACEFILTERGEN=function(){function Fb(a){var c=null,d=null,e=null,m=0;this.A=function(n){this.Cf(n.ob);e.Ce({qc:n.qc,nc:n.nc})};this.Xe=function(n){return c[n]};this.Cf=function(n){var q=null;m=n.length;c=n.map(function(r,l){r=Object.assign({},r,{index:l,parent:this,vb:q,gf:l===m-1});return q=l=0===l?Gb.instance(r):Hb.instance(r)});d=c[0];e=c[m-1];c.forEach(function(r,l){0!==l&&r.uf()})};this.V=function(n){var q=n;c.forEach(function(r){q=r.V(q,!1)});return q};this.We=function(){return d.F()};
this.Xb=function(){return e.Ye()};this.nd=function(){return e.nd()};this.m=function(){c&&(c.forEach(function(n){n.m()}),e=d=c=null,m=0)};"undefined"!==typeof a&&this.A(a)}function db(a,c){var d=c%8;return a[(c-d)/8]>>7-d&1}function Ib(a){var c=JSON.parse(a);a=c.ne;var d=c.nf,e=c.n;var m="undefined"===typeof btoa?Buffer.from(c.data,"base64").toString("latin1"):atob(c.data);var n=m.length;c=new Uint8Array(n);for(var q=0;q<n;++q)c[q]=m.charCodeAt(q);m=new Float32Array(e);n=new Float32Array(d);q=a+d+
1;for(var r=0;r<e;++r){for(var l=q*r,v=0===db(c,l)?1:-1,C=l+1,E=1,g=0,t=C+a-1;t>=C;--t)g+=E*db(c,t),E*=2;C=g;l=l+1+a;E=n.length;g=0;for(t=l;t<l+E;++t)n[g]=db(c,t,!0),++g;for(E=l=0;E<d;++E)l+=n[E]*Math.pow(2,-E-1);m[r]=0===l&&0===C?0:v*(1+l)*Math.pow(2,1+C-Math.pow(2,a-1))}return m}function Ya(){return-1!==[ha.ready,ha.play,ha.pause].indexOf(na)}function eb(){if(na===ha.play)return!1;na=ha.play;Ma.stop();qb(0)}function rb(){if(na!==ha.play)return!1;Ma.stop();na=ha.pause;return!0}function Fa(a,c,d,
e,m){a=4*(3*c+a)+d;return e+(X.buffer[a]/255+X.buffer[a+12]/65025)*(m-e)}function fb(){b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);va.ha();U.reset();Y.reset();B.R();B.ad();b.disable(b.DEPTH_TEST);b.disable(b.BLEND);U.Ia();B.Aa()}function Jb(){va.P();b.viewport(0,0,3,2*O.o);B.set("s52");X.Ca.g(0);U.l(!1,!1);return ba.xb(0,0,3,2*O.o,X.buffer)}function qb(){na!==ha.pause&&(ja.isCleanGLStateAtEachIteration&&(B.ad(),U.reset(),U.Ia(),b.disable(b.DEPTH_TEST),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),B.Aa()),pa.rc(Kb,
Jb,Lb,Mb,ja.animateProcessOrder))}function Kb(){va.ha();if(!A.jb)if(A.ib)A.element.needsUpdate&&(A.N.Rf(A.element.arrayBuffer),A.element.needsUpdate=!1);else{var a=A.element.currentTime,c=a-A.wb;0>c&&(A.wb=a);1E3*c<aa.Tf||(A.wb+=c,A.N.refresh())}a=pa.od();if(O.W.length>a)O.W.splice(0,O.W.length-a);else for(;O.W.length<a;)O.W.push(0);if(1!==O.o)if(qa.every(gb)){for(var d=0,e=c=0;e<qa.length;++e)qa[e].detected>d&&(d=qa[e].detected,c=0);for(d=0;d<a;++d)O.W[d]=c}else{c=O.Fd;d=0;for(e=!1;d<a;++d){if(gb(qa[c]))if(e){do++c===
O.o&&(c=0);while(gb(qa[c]))}else e=!0;O.W[d]=c++;c>=O.o&&(c=0)}O.Fd=c}for(a=0;a<pa.od();++a)O.pa=O.W[a],O.mc=(.5+O.pa)/O.o,O.Ad=O.W.lastIndexOf(O.pa)===a,B.set("s54"),c=qa[O.pa],B.H("u42",1+Na.uc*(Math.cos(c.ry)-1)),Q.ua&&B.H("u41",c.rz),1!==O.o&&B.H("u40",O.mc),Z.xa.da(),A.N.g(0),X.Ca.g(1),U.l(!1,!1),Z.xa.g(0),Oa.V(Z.xa);pa.be()}function Lb(){for(var a=0;a<O.o;++a)if(-1!==O.W.indexOf(a)){var c=a,d=Sa[c],e=[c],m=qa[c],n=hb[c],q=2*c;d.Va=Fa(1,q,3,0,1);m.detected=wa.$(m.detected,d.Va,aa.le);if(d.Va<
aa.Hd)Q.ua&&(m.rz=0,m.ry=0);else{var r=X.Oa;d.x=Fa(0,q,1,-1,1);d.y=Fa(0,q,2,-1,1);d.ca=Fa(0,q,3,0,1);d.sc=Fa(1,q,0,-r[0],r[0]);d.tc=Fa(1,q,1,-r[1],r[1]);d.Pa=Fa(1,q,2,-r[2],r[2]);for(r=0;r<X.aa;++r)d.hd[r]=X.Ma[r](Fa(2,q,r,0,1));e.Rb=d.x-m.xRaw;e.Sb=d.y-m.yRaw;e.Qb=d.ca-m.sRaw;e.Nb=d.sc-m.rx;e.Ob=d.tc-m.ry;e.Pb=Q.ua?d.Pa:d.Pa-m.rz;q=pa.Re();e=(1-Za.pb(sa.translationFactorRange[0],sa.translationFactorRange[1],Math.sqrt(e.Rb*e.Rb+e.Sb*e.Sb+e.Qb*e.Qb)/q))*(1-Za.pb(sa.rotationFactorRange[0],sa.rotationFactorRange[1],
Math.sqrt(e.Nb*e.Nb+e.Ob*e.Ob+e.Pb*e.Pb)/q))*Za.pb(sa.qualityFactorRange[0],sa.qualityFactorRange[1],d.Va);c=n[++ib[c]%n.length]=e;for(q=0;q<n.length;++q)c=Math.min(c,n[q]);c=Math.max(.5,c);e=Math.min(c,e);n=wa.$(sa.alphaRange[1],sa.alphaRange[0],Math.pow(e,aa.oe));m.xRaw=wa.$(m.xRaw,d.x,n);m.yRaw=wa.$(m.yRaw,d.y,n);m.sRaw=wa.$(m.sRaw,d.ca,n);m.rx=wa.$(m.rx,d.sc,n);m.ry=wa.$(m.ry,d.tc,n);m.rz=Q.ua?m.rz+sa.followZRotAlphaFactor*n*d.Pa:wa.$(m.rz,d.Pa,n);c=m.sRaw*Na.Mb*Math.sin(m.ry);e=Math.sin(m.rz)*
c/Pa;m.x=m.xRaw+Math.cos(m.rz)*c;m.y=m.yRaw+e;m.s=m.sRaw;n=Math.max(n,aa.me);for(c=0;c<X.aa;++c)m.expressions[c]=wa.$(m.expressions[c],d.hd[c],n);++d.sb}}va.Pf();ja.isCleanGLStateAtEachIteration&&(va.reset(),Y.reset(),b.enable(b.DEPTH_TEST));Q.Ua&&(1===O.o?Q.Ua(qa[0]):Q.Ua(qa));ja.isCleanGLStateAtEachIteration&&b.disable(b.BLEND)}function Mb(){na===ha.play&&Ma.rc(qb)}function sb(){Z.xa=Y.instance({isPot:!0,isFloat:!1,width:Oa.We()});for(var a=aa.Zd,c=O.o,d=new Float32Array([0,.5,.5,0,0,0,0,0,0,0,
0,0]),e=new Float32Array(d.length*O.o),m=0,n;m<O.o;++m)for(n=0;n<d.length;++n)e[m*d.length+n]=d[n];X.Ca=Nb.instance({width:a,height:c,isFloat:!0,isPot:!1,array:e})}function Ob(){function a(c){for(var d=[],e=0;e<O.o;++e)d.push(JSON.parse(JSON.stringify(c)));return d}X.buffer=new Uint8Array(8*aa.Zd*O.o);Sa=a({Va:0,x:0,y:0,ca:1,sc:0,tc:0,Pa:0,hd:new Float32Array(X.aa),sb:0});qa=a({detected:0,x:0,y:0,s:1,xRaw:0,yRaw:0,sRaw:1,rx:0,ry:0,rz:0,expressions:new Float32Array(X.aa)});a({Rb:0,Sb:0,Qb:0,Nb:0,Ob:0,
Pb:0})}function jb(){B.T("s54",[{type:"1i",name:"u1",value:0},{type:"1i",name:"u38",value:1},{type:"2f",name:"u39",value:Z.G},{type:"1f",name:"u40",value:.5},{type:"1f",name:"u41",value:0}]);B.T("s55",[{type:"1i",name:"u43",value:0},{type:"1i",name:"u38",value:1},{type:"1f",name:"u46",value:aa.Nf},{type:"1f",name:"u47",value:ja.threshold},{type:"3f",name:"u45",value:[X.O[0]*Z.G[0],X.O[1]*Z.G[1],X.O[2]]},{type:"1f",name:"u40",value:.5},{type:"1f",name:"u48",value:1},{type:"1f",name:"u41",value:0}]);
var a=[{type:"1i",name:"u43",value:0}];B.T("s56",a);B.T("s57",a);B.T("s52",[{type:"1i",name:"u38",value:0},{type:"1f",name:"u51",value:Z.G[0]},{type:"2f",name:"u50",value:[0,.5/O.o]}])}function kb(){Z.G[0]=1;Z.G[1]=Z.D/Z.M;tb.A({ub:ja.overlapFactors,Ld:ja.nScaleLevels,D:Z.D,M:Z.M,Ud:ja.scale0Factor,O:X.O,Vd:ja.scanCenterFirst})}function Pb(a){if(Q.Ea)ub("string"===typeof Q.Ea?JSON.parse(Q.Ea):Q.Ea,a);else{var c=Q.Mc;"JSON"!==c.toUpperCase().split(".").pop()&&(c+=aa.neuralNetworkPath);vb.get(c,function(d){d=
JSON.parse(d);ub(d,a)})}}function ub(a,c){if(a.exportData){var d=a.exportData;d.rotationEulerAnglesFactors&&(X.Oa=d.rotationEulerAnglesFactors);d.translationScalingFactors&&(X.O=d.translationScalingFactors);"undefined"!==typeof d.nExpressions&&(X.aa=d.nExpressions);Na.uc=.4;Na.Mb=.7;"undefined"!==typeof d.fgScaleXFactor&&(Na.uc=d.fgScaleXFactor);"undefined"!==typeof d.fgDisplaceXFactor&&(Na.Mb=d.fgDisplaceXFactor)}X.aa||(X.aa=aa.Kd);if(!X.Ma)for(X.Ma=[],d=0;d<X.aa;++d)X.Ma.push(aa.Le);c(a)}function Qb(){if(Qa.A({Jb:Q.ia,
width:Z.D,height:Z.M,debug:!1,Md:function(){Ha("GLCONTEXT_LOST")},antialias:Q.antialias,premultipliedAlpha:!0}))return!0;Ha("GL_INCOMPATIBLE");return!1}function gb(a){return a.detected<=aa.Hd}function wb(a,c,d,e){return d>a?Math.max(0,a+c/2-(d-e/2)):Math.max(0,d+e/2-(a-c/2))}function Rb(){return Sa.some(function(a,c){if(c===O.pa)return!1;c=Sa[O.pa];if(c.sb>a.sb||3>a.sb||wb(c.x,c.ca,a.x,a.ca)<aa.Id*c.ca)return!1;var d=Z.D/Z.M;return wb(c.y,c.ca*d,a.y,a.ca*d)>aa.Id*c.ca*d})}function Sb(){var a=O.pa;
X.Ca.Bf(1);1!==O.o&&(b.viewport(0,0,3,O.o),B.set("s0"),B.Yd("u1",1),U.l(!1,!1),B.Yd("u1",0));b.viewport(0,a,1,1);B.set("s55");Q.ua&&B.H("u41",qa[a].rz);1!==O.o&&B.H("u40",O.mc);if(1<O.o){var c=Rb()?0:1;B.H("u48",c)}B.Gf("u44",tb.get());U.l(!1,!1);O.Ad&&(b.viewport(1,a,1,1),B.set("s56"),U.l(!1,!1),b.viewport(2,a,1,1),B.set("s57"),U.l(!1,!1))}function xb(){A.N&&A.N.remove();A.ib=A.element.isFakeVideo?!0:!1;if(A.ib){var a=yb();a={isFlipY:!1,array:A.element.arrayBuffer,width:a.w,height:a.wa,isKeepArray:!0}}else a=
{I:A.element};A.zc=Y.instance(Object.assign({isPot:!1,isLinear:!0,isFloat:!1},a));A.N=A.zc}function Ia(){var a=[{type:"mat2",name:"u37",value:A.v}];B.T("s53",[{type:"1i",name:"u1",value:0}].concat(a));B.T("s54",a)}function Ja(){A.L[0]=.5;A.L[1]=.5;var a=A.G[1]/A.G[0];Pa=Qa.U()/Qa.F();90===Math.abs(oa.rotate)&&(a=1/a);a>Pa?A.L[1]*=Pa/a:A.L[0]*=a/Pa;B.T("s55",[{name:"u49",type:"1f",value:Pa}]);A.v[0]=0;A.v[1]=0;A.v[2]=0;A.v[3]=0;switch(oa.rotate){case 0:A.v[0]=A.L[0];A.v[3]=A.L[1];break;case 180:A.v[0]=
-A.L[0];A.v[3]=-A.L[1];break;case 90:A.v[1]=A.L[0];A.v[2]=-A.L[1];break;case -90:A.v[1]=-A.L[0],A.v[2]=A.L[1]}oa.flipX&&(A.v[0]*=-1,A.v[2]*=-1);A.jb||(A.v[1]*=-1,A.v[3]*=-1)}function yb(){var a={w:A.element.videoWidth||A.element.width,wa:A.element.videoHeight||A.element.height};if(!a.w||!a.wa||4>a.w||4>a.wa)throw Error("INVALID VIDEO DIMENSIONS - width = "+a.w+" height = "+a.wa);return a}function lb(){var a=yb(),c=A.G[0]!==a.w||A.G[1]!==a.wa;c&&(A.G[0]=a.w,A.G[1]=a.wa);return c}function $a(a,c){if(na===
ha.error)return!1;A.element=a;lb();c&&c();return!0}function zb(a,c,d){a&&a();A.Ka={video:{facingMode:{exact:oa.facingMode},width:{min:oa.minWidth,max:oa.maxWidth,ideal:oa.idealWidth},height:{min:oa.minHeight,max:oa.maxHeight,ideal:oa.idealHeight}},audio:!1};W.Oc(A.Ka,oa.deviceId);W.get(A.element?A.element:W.$e(),function(e){c&&c(e);d(e)},function(){Ha("WEBCAM_UNAVAILABLE")},A.Ka)}function Ha(a){na!==ha.error&&(na=ha.error,Q.Ja&&Q.Ja(a))}var wa={Qg:function(a){return Math.ceil(Math.log2(a))},jh:function(a){return Math.log2(a)},
fh:function(a){return 0===Math.log2(a)%1},dg:function(a){var c=[0,0,0,0];a.forEach(function(d){c[0]+=d[0];c[1]+=d[1];c[2]+=d[2];c[3]+=d[3]});return c},eg:function(a,c,d){return Math.min(Math.max(a,c),d)},hg:function(a){return a*Math.PI/180},oh:function(a,c){c=Math.pow(10,c);return Math.round(a*c)/c},ph:function(a){return Math.round(1E6*a)/1E6},Rg:function(a,c){return(100*a/c).toFixed(3)},$:function(a,c,d){return a*(1-d)+c*d},He:function(a,c){return wa.ze(a-c)},ze:function(a){for(;a>Math.PI;)a-=2*
Math.PI;for(;a<=-Math.PI;)a+=2*Math.PI;return a},kg:function(a,c){return Math.abs(wa.He(a,c))},Uf:function(a,c){return Math.atan2(Math.sin(a)+Math.sin(c),Math.cos(a)+Math.cos(c))}},vb={get:function(a,c,d){var e=new XMLHttpRequest;e.open("GET",a,!0);e.withCredentials=!1;e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?c(e.responseText):"undefined"!==typeof d&&d(e.status))};e.send()},Ng:function(a,c){vb.get(a,function(d){c(JSON.parse(d))})},lh:function(a,c,d){var e=new XMLHttpRequest;
e.open("POST",a,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&0!==e.status||d(e.responseText)};e.send(c)},Bg:function(a,c){var d=new XMLHttpRequest;d.open("POST",a,!0);d.responseType="arraybuffer";d.onload=function(){c(d.response)};d.send()}},Tb={create:function(a,c){for(var d=Array(c),e=0;e<c;++e)d[e]=a;return d},ig:function(a,c){for(var d=0;d<a.length;++d)c[d]=a[d]},clone:function(a){for(var c=Array(a.length),
d=0;d<a.length;++d)c[d]=a[d];return c},sh:function(a,c,d){a.forEach(function(e,m){c[m]=e*d})},Ch:function(a){for(var c=a.length-1;0<c;--c){var d=Math.floor(Math.random()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}},Mf:function(a){return Array.isArray(a)||a.constructor===Float32Array||a.constructor===Uint8Array}},mb={Kb:function(a,c){if(0===c||"object"!==typeof a)return a;a=Object.assign({},a);c=void 0===c||-1===c?-1:c-1;for(var d in a)a[d]=mb.Kb(a[d],c);return a}},Za={Dh:function(a,c,d){a=Math.min(Math.max((d-
a)/(c-a),0),1);return a*a*(3-2*a)},pb:function(a,c,d){return Math.min(Math.max((d-a)/(c-a),0),1)},vg:function(a,c,d,e){return Math.pow(Math.min(Math.max((e-a)/(c-a),0),1),d)},Hh:function(){return 0},kh:function(){return 1},ih:function(a){return a},sg:function(a){return a*a},xg:function(a){return a*(2-a)},pg:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},ng:function(a){return a*a*a},wg:function(a){return--a*a*a+1},og:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},tg:function(a){return a*a*a*a},
yg:function(a){return 1- --a*a*a*a},qg:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},ug:function(a){return a*a*a*a*a},zg:function(a){return 1+--a*a*a*a*a},rg:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}},Ub={Ne:function(a,c,d){switch(a){case "relu":return d+"=max(vec4(0.,0.,0.,0.),"+c+");";case "elu":return d+"=mix(exp(-abs("+c+"))-vec4(1.,1.,1.,1.),"+c+",step(0.,"+c+"));";case "elu01":return d+"=mix(0.1*exp(-abs("+c+"))-vec4(0.1,0.1,0.1,0.1),"+c+",step(0.,"+c+"));";case "arctan":return d+
"=atan(3.14159265359*texture2D(u0,vUV))/3.14159265359;";case "copy":return"";default:return!1}}},B=function(){function a(u,f,y){f=u.createShader(f);u.shaderSource(f,y);u.compileShader(f);return u.getShaderParameter(f,u.COMPILE_STATUS)?f:!1}function c(u,f,y){f=a(u,u.VERTEX_SHADER,f);y=a(u,u.FRAGMENT_SHADER,y);u===b&&q.push(f,y);var G=u.createProgram();u.attachShader(G,f);u.attachShader(G,y);u.linkProgram(G);return G}function d(u,f){f.C=f.C?!0:!1;if(!f.C){void 0===f.ta&&(f.ta="precision lowp float;attribute vec2 a0;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=a0*.5+vec2(.5,.5);}");
void 0===f.Sa&&(f.Sa=["a0"]);void 0===f.Ga&&(f.Ga=[2]);if(void 0===f.precision||"highp"===f.precision)f.precision=E;f.id=v++;void 0!==f.Wd&&(f.Wd.forEach(function(G,L){f.h=f.h.replace(G,f.yb[L])}),f.Wd.splice(0));f.Hc=0;f.Ga.forEach(function(G){f.Hc+=4*G});f.ra=c(u,f.ta,"precision "+f.precision+" float;\n"+f.h);f.B={};f.i.forEach(function(G){f.B[G]=u.getUniformLocation(f.ra,G)});f.attributes={};f.Ha=[];f.Sa.forEach(function(G){var L=u.getAttribLocation(f.ra,G);f.attributes[G]=L;f.Ha.push(L)});if(f.j){u.useProgram(f.ra);
l=f;r=f.id;for(var y in f.j)u.uniform1i(f.B[y],f.j[y])}f.qa=!0}}function e(u){xa.Ff(M);r!==u.id&&(M.R(),r=u.id,l=u,b.useProgram(u.ra),u.Ha.forEach(function(f){0!==f&&b.enableVertexAttribArray(f)}))}function m(u,f,y){d(u,f,y);u.useProgram(f.ra);u.enableVertexAttribArray(0);r=-1;return l=f}function n(){return{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:["u1"],j:{u1:0}}}var q=[],r=-1,l=null,v=0,C=!1,E="highp",g=["u1"],t=["u0"],x={u1:0},k={u0:0},p={u1:0,u2:1},
H={u3:0},I={s0:n(),s1:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:g,j:x,precision:"lowp"},s2:{h:"uniform sampler2D u1,u2;varying vec2 vv0;void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a*b;}",i:["u1","u2"],j:p},s3:{h:"uniform sampler2D u1;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a.r*f;}",i:g,j:x},s4:{h:"uniform sampler2D u1,u2;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u2,vv0),b=texture2D(u1,vv0);gl_FragColor=a.a*b.r*f;}",
i:["u1","u2"],j:p},s5:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(1.-vv0.x,vv0.y));}",i:g,j:x},s6:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vec2(vv0.x,1.-vv0.y));}",i:g,j:x},s7:{h:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=a*u4;}",i:["u0","u4"],j:k},s8:{h:"uniform sampler2D u0;uniform float u4;varying vec2 vv0;const vec4 f=vec4(.25,.25,.25,.25),g=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);float b=dot(a*u4,f);gl_FragColor=b*g;}",
i:["u0","u4"],j:k},s9:{h:"uniform sampler2D u1;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){float a=.25*dot(e,texture2D(u1,vv0));gl_FragColor=a*e;}",i:g,j:x},s10:{h:"uniform sampler2D u1,u5;uniform float u6;const vec4 f=vec4(1.,1.,1.,1.);varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0),b=texture2D(u5,vv0);gl_FragColor=mix(b,a,u6*f);}",i:["u1","u5","u6"],j:{u1:0,u5:1}},s11:{h:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;void main(){gl_FragColor=.25*(texture2D(u1,vv0+u7)+texture2D(u1,vv0+u7*vec2(1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,-1.))+texture2D(u1,vv0+u7*vec2(-1.,1.)));}",
i:["u1","u7"],j:x},s12:{h:"uniform sampler2D u1;uniform vec4 u8;varying vec2 vv0;float g(float a,float b){a=floor(a)+.5;return floor(a/exp2(b));}float h(float a,float b){return floor(a*exp2(b)+.5);}float i(float a,float b){return mod(a,h(1.,b));}float e(float c,float a,float b){a=floor(a+.5),b=floor(b+.5);return i(g(c,a),b-a);}vec4 j(float a){if(a==0.)return vec4(0.,0.,0.,0.);float k=128.*step(a,0.);a=abs(a);float c=floor(log2(a)),l=c+127.,b=(a/exp2(c)-1.)*8388608.,d=l/2.,m=fract(d)*2.,n=floor(d),o=e(b,0.,8.),p=e(b,8.,16.),q=m*128.+e(b,16.,23.),r=k+n;return vec4(o,p,q,r)/255.;}void main(){float a=dot(texture2D(u1,vv0),u8);gl_FragColor=j(a);}",
i:["u1","u8"],j:x},s13:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=e/(e+exp(-a));gl_FragColor=b;}",i:t,j:k,C:!0},s14:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(0.,0.,0.,0.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=max(f,a);}",i:t,j:k},s15:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0);gl_FragColor=mix(exp(-abs(a))-f,a,step(0.,a));}",i:t,j:k},
s16:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=exp(-abs(a))-f;gl_FragColor=mix(.1*b,a,step(0.,a));}",i:t,j:k},s17:{h:"uniform sampler2D u0,u6,u9;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),c=texture2D(u6,vv0),d=texture2D(u9,vv0),b=a/d;gl_FragColor=c*mix(exp(-abs(b))-f,b,step(0.,a));}",i:["u0","u6","u9"],j:{u0:0,u6:1,u9:2},C:!0},s18:{h:"uniform sampler2D u0;const float e=3.141593;varying vec2 vv0;void main(){gl_FragColor=atan(e*texture2D(u0,vv0))/e;}",
i:t,j:k},s19:{h:"uniform sampler2D u0;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=texture2D(u0,vv0),b=log(f+a);gl_FragColor=b;}",i:t,j:k,C:!0},s20:{h:"uniform sampler2D u0,u10;uniform float u11;const vec2 e=vec2(.5,.5);const float f=1e-5;const vec4 g=vec4(1.,1.,1.,1.),i=vec4(0.,0.,0.,0.);varying vec2 vv0;void main(){vec4 a=texture2D(u10,e);float b=u11*u11;vec4 c=max(b*a,f*g);gl_FragColor=texture2D(u0,vv0)/c;}",i:["u0","u10","u11"],j:{u0:0,u10:1},C:!0},s21:{h:"uniform sampler2D u1;uniform vec2 u12;varying vec2 vv0;void main(){float a=u12.x*u12.y;vec2 b=floor(vv0*a)/a,c=fract(vv0*a),d=floor(b*u12.y),f=floor(u12.x*fract(b*u12.y)),g=(f*u12.y+d)/a;gl_FragColor=texture2D(u1,g+c/a);}",
i:["u1","u12"],j:x},s22:{h:"uniform sampler2D u13,u14,u15;varying vec2 vv0;void main(){vec4 a=texture2D(u15,vv0);vec2 b=a.rg,c=a.ba;vec4 d=texture2D(u13,b),f=texture2D(u14,c);gl_FragColor=d*f;}",i:["u13","u14","u15"],j:{u14:0,u13:1,u15:2},C:!0},s23:{h:"uniform float u16;uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec2 a=fract(vv0*u16);vec4 b=texture2D(u13,vv0),c=texture2D(u14,a);gl_FragColor=b*c;}",i:["u14","u13","u16"],j:{u14:0,u13:1}},s24:{h:"uniform float u16;uniform sampler2D u13,u14,u17,u18,u19,u20;varying vec2 vv0;const vec4 e=vec4(1.,1.,1.,1.),g=vec4(1e-3,1e-3,1e-3,1e-3);void main(){vec2 h=vv0*u16,l=floor(h),c=h-l;vec4 m=texture2D(u13,vv0),d=texture2D(u14,c),a=texture2D(u20,vv0);a=a*255.;vec4 n=texture2D(u17,c),o=texture2D(u18,c),p=texture2D(u19,c),i=step(-g,-a),b=e-i,j=b*step(-e-g,-a);b*=e-j;vec4 k=b*step(-2.*e-g,-a);b*=e-k;vec4 q=b;d=i*d+j*n+k*o+q*p,gl_FragColor=m*d;}",
i:"u13 u14 u16 u20 u17 u18 u19".split(" "),j:{u14:0,u13:1,u20:3,u17:4,u18:5,u19:6},C:!0},s25:{h:"uniform sampler2D u13,u14,u21;uniform float u16,u22,u23,u24;varying vec2 vv0;const vec2 j=vec2(1.,1.);void main(){vec2 a=floor(u22*vv0),b=u22*vv0-a;float c=u16/u22;vec2 d=floor(b*c),f=b*c-d,g=(a+f)/u22;float k=u22*u24/u16;vec2 l=k*d,h=(l+f*u23)/u24,i=step(h,j);vec4 m=texture2D(u13,g),n=texture2D(u14,h),o=m*n*i.x*i.y,p=texture2D(u21,g);gl_FragColor=o*u23*u23+p;}",i:"u13 u14 u16 u22 u23 u24 u21".split(" "),
j:{u14:0,u13:1,u21:2}},s26:{h:"uniform sampler2D u13,u14;varying vec2 vv0;void main(){vec4 a=texture2D(u13,vv0),b=texture2D(u14,vv0);gl_FragColor=a*b;}",i:["u13","u14"],j:{u14:0,u13:1},C:!0},s27:{h:"uniform sampler2D u1,u21;uniform float u25;varying vec2 vv0;void main(){gl_FragColor=texture2D(u21,vv0)+u25*texture2D(u1,vv0);}",i:["u1","u21","u25"],j:{u1:0,u21:1}},s28:{h:"varying vec2 vv0;uniform sampler2D u1;const vec4 f=vec4(1.,1.,1.,1.),g=vec4(.299,.587,.114,0.);void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=dot(a,g)*f;}",
i:g,j:x,precision:"lowp"},s29:{h:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(dot(a,f),dot(b,f),dot(c,f),dot(d,f));}",i:["u1","u26"],j:x,precision:"lowp"},s30:{h:"varying vec2 vv0;uniform sampler2D u1;uniform float u26;const vec3 f=vec3(.299,.587,.114);void main(){vec3 a=texture2D(u1,vv0).rgb,b=texture2D(u1,vv0+vec2(0.,u26)).rgb,c=texture2D(u1,vv0+vec2(u26,u26)).rgb,d=texture2D(u1,vv0+vec2(u26,0.)).rgb;gl_FragColor=vec4(a.r,b.g,c.b,dot(d,f));}",
i:["u1","u26"],j:x,precision:"lowp"},s31:{h:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 f=vec4(1.,1.,1.,1.);void main(){vec4 a=vec4(0.);a-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y))*2.,a-=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y))*2.,a+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec4 b=vec4(0.);b-=texture2D(u1,vec2(vv0.x-u27,vv0.y-u27))*1.,b-=texture2D(u1,vec2(vv0.x,vv0.y-u27))*2.,b-=texture2D(u1,vec2(vv0.x+u27,vv0.y-u27))*1.,b+=texture2D(u1,vec2(vv0.x-u27,vv0.y+u27))*1.,b+=texture2D(u1,vec2(vv0.x,vv0.y+u27))*2.,b+=texture2D(u1,vec2(vv0.x+u27,vv0.y+u27))*1.;vec3 c=sqrt(a.rgb*a.rgb+b.rgb*b.rgb);vec4 e=vec4(c,texture2D(u1,vv0).a),g=texture2D(u2,vv0);gl_FragColor=g.a*e.r*f;}",
i:["u1","u2","u27"],j:p,C:!0},s32:{h:"varying vec2 vv0;uniform sampler2D u1,u2;uniform float u27;const vec4 j=vec4(1.,1.,1.,1.);const vec2 k=vec2(1.,1.);void main(){float h=0.;vec2 l=k*u27,a,b;float c,d,i=0.;for(float e=-4.;e<=4.;e+=1.)for(float f=-4.;f<=4.;f+=1.)a=vec2(e,f),c=length(a)/2.,d=exp(-c*c),b=vv0+l*a,h+=d*texture2D(u1,b).r,i+=d;vec4 m=texture2D(u2,vv0);gl_FragColor=m.a*(texture2D(u1,b).r-h/i)*j;}",i:["u1","u2","u27"],j:p,C:!0},s33:{h:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}const vec2 g=vec2(.5,.5),h=vec2(1.,0.),i=vec2(0.,1.);void main(){vec2 a=vv0-u7*g;vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*h),d=texture2D(u3,a+u7*i),j=texture2D(u3,a+u7),k=e(b,c),l=e(d,j);gl_FragColor=e(k,l);}",
i:["u3","u7"],j:H},s34:{h:"uniform sampler2D u3;uniform vec2 u7;varying vec2 vv0;const vec2 k=vec2(1.,0.),l=vec2(0.,1.),m=vec2(2.,0.),n=vec2(0.,2.);vec4 e(vec4 a,vec4 b){vec4 c=step(a,b);return mix(a,b,c);}vec4 f(vec2 a){vec4 b=texture2D(u3,a),c=texture2D(u3,a+u7*k),d=texture2D(u3,a+u7*l),g=texture2D(u3,a+u7),h=e(b,c),i=e(d,g);return e(h,i);}void main(){vec2 a=vv0+u7*vec2(-.55,-1.05);vec4 b=f(a),c=f(a+u7*m),d=f(a+u7*2.),g=f(a+u7*n),h=e(b,c),i=e(d,g);gl_FragColor=e(h,i);}",i:["u3","u7"],j:H,C:!0},
s35:{h:"uniform sampler2D u1;varying vec2 vv0;void main(){vec4 a=texture2D(u1,vv0);gl_FragColor=a*a;}",i:["u1"],j:x,precision:"lowp",C:!0},s36:{h:"uniform sampler2D u1;uniform vec2 u7;varying vec2 vv0;const float e=15444.;void main(){vec4 a=1001./e*texture2D(u1,vv0-3.*u7)+2002./e*texture2D(u1,vv0-2.*u7)+3003./e*texture2D(u1,vv0-u7)+3432./e*texture2D(u1,vv0)+3003./e*texture2D(u1,vv0+u7)+2002./e*texture2D(u1,vv0+2.*u7)+1001./e*texture2D(u1,vv0+3.*u7);gl_FragColor=a;}",i:["u7","u1"],j:x,precision:"lowp",
C:!0},s37:{h:"uniform sampler2D u1,u10,u28;varying vec2 vv0;const vec4 f=vec4(1.,1.,1.,1.);const float g=.1;void main(){vec4 a=texture2D(u10,vv0),b=texture2D(u28,vv0),c=texture2D(u1,vv0),d=max(f*g,b-a*a),h=sqrt(d);gl_FragColor=(c-a)/h;}",i:["u1","u10","u28"],j:{u1:0,u10:1,u28:2},C:!0}},N={s38:{h:"uniform float u16,u29;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-5,1e-5);void main(){vec4 sum=texture2D(u21,vv0);float toSparsity=1.1111;vec2 uvFrom,uvWeight,xyPatch=ZERO2,eps2=EPS2/u16,xyTo=floor(vv0*u16+eps2);float weightSize=toSparsity*u16;vec2 halfFromSparsity=ONE2*(toSparsity-1.)/2.;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.)xyPatch.y=patch_y,uvFrom=(xyTo+HALF2+u29*(xyPatch-halfFromSparsity))/u16,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),uvWeight=(xyTo*toSparsity+xyPatch+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:["u16","u13","u14","u21","u29"],yb:["1.1111","gl_FragColor\\*=2.2222;"]},s39:{h:"uniform float u16,u29,u24;uniform sampler2D u13,u14,u21;varying vec2 vv0;const vec2 ZERO2=vec2(0.,0.),ONE2=vec2(1.,1.),HALF2=vec2(.5,.5),EPS2=vec2(1e-4,1e-4);void main(){vec4 sum=texture2D(u21,vv0);float fromSparsity=1.1111,shrinkFactor=3.3333;vec2 uvFrom,uvWeight,xyFrom,xyPatchTo,xyPatch=ZERO2,xyShrink=ZERO2,eps2=EPS2/u24,xyTo=floor(vv0*u16+eps2);float weightSize=fromSparsity*u24;vec2 halfFromSparsity=ONE2*(fromSparsity-1.)/2.;float toSparsity=weightSize/u16;vec2 xyFrom0=xyTo*shrinkFactor;for(float patch_x=0.;patch_x<1.1111;patch_x+=1.){xyPatch.x=patch_x;for(float patch_y=0.;patch_y<1.1111;patch_y+=1.){xyPatch.y=patch_y;for(float shrink_x=0.;shrink_x<3.3333;shrink_x+=1.){xyShrink.x=shrink_x;for(float shrink_y=0.;shrink_y<3.3333;shrink_y+=1.)xyShrink.y=shrink_y,xyFrom=xyFrom0+xyShrink+shrinkFactor*u29*(xyPatch-halfFromSparsity),uvFrom=(xyFrom+HALF2)/u24,uvFrom+=step(uvFrom,-eps2),uvFrom-=step(ONE2-eps2,uvFrom),xyPatchTo=xyPatch*shrinkFactor+xyShrink,uvWeight=(xyTo*toSparsity+xyPatchTo+HALF2)/weightSize,sum+=texture2D(u13,uvWeight)*texture2D(u14,uvFrom);}}}gl_FragColor=sum,gl_FragColor*=2.2222;}",
i:"u16 u24 u13 u14 u21 u29".split(" "),yb:["1.1111","gl_FragColor\\*=2.2222;","3.3333"]}},z=null,J=null,M={mb:function(){return C},A:function(){if(!C){z=mb.Kb(I,2);J=mb.Kb(N,2);E="highp";for(var u in z)d(b,z[u],u);B.set("s0");b.enableVertexAttribArray(0);C=!0}},Qc:function(u){u.forEach(function(f){M.Pc(f)})},Pc:function(u){z[u.id]=u;d(b,u,u.id)},sd:function(u,f,y){f||(f=u);z[f]=Object.create(J[u]);z[f].ff=!0;J[u].yb&&J[u].yb.forEach(function(G,L){z[f].h=z[f].h.replace(new RegExp(G,"g"),y[L])});d(b,
z[f],f)},set:function(u){var f=z[u];f.C&&(f.C=!1,d(b,f,u));e(f)},Qa:function(u){return m(u,n(),"s40")},wc:function(u){return m(u,{h:"void main(){gl_FragColor=vec4(.5,.5,.5,.5);}",i:[],precision:"highp"},"s41")},Ke:function(u){return"undefined"===typeof z[u]?!1:z[u].qa},R:function(){-1!==r&&(r=-1,l.Ha.forEach(function(u){0!==u&&b.disableVertexAttribArray(u)}))},yc:function(){var u=0;l.Ha.forEach(function(f,y){y=l.Ga[y];b.vertexAttribPointer(f,y,b.FLOAT,!1,l.Hc,u);u+=4*y})},ad:function(){b.enableVertexAttribArray(0)},
Aa:function(){M.zb(b)},zb:function(u){u.vertexAttribPointer(l.Ha[0],2,u.FLOAT,!1,8,0)},Yd:function(u,f){b.uniform1i(l.B[u],f)},H:function(u,f){b.uniform1f(l.B[u],f)},sa:function(u,f,y){b.uniform2f(l.B[u],f,y)},wh:function(u,f){b.uniform2fv(l.B[u],f)},Gf:function(u,f){b.uniform3fv(l.B[u],f)},xh:function(u,f,y,G){b.uniform3f(l.B[u],f,y,G)},yh:function(u,f,y,G,L){b.uniform4f(l.B[u],f,y,G,L)},xc:function(u,f){b.uniform4fv(l.B[u],f)},zh:function(u,f){b.uniformMatrix2fv(l.B[u],!1,f)},Ah:function(u,f){b.uniformMatrix3fv(l.B[u],
!1,f)},Bh:function(u,f){b.uniformMatrix4fv(l.B[u],!1,f)},T:function(u,f){M.set(u);f.forEach(function(y){switch(y.type){case "4f":b.uniform4fv(l.B[y.name],y.value);break;case "3f":b.uniform3fv(l.B[y.name],y.value);break;case "2f":b.uniform2fv(l.B[y.name],y.value);break;case "1f":b.uniform1f(l.B[y.name],y.value);break;case "1i":b.uniform1i(l.B[y.name],y.value);break;case "mat2":b.uniformMatrix2fv(l.B[y.name],!1,y.value);break;case "mat3":b.uniformMatrix3fv(l.B[y.name],!1,y.value);break;case "mat4":b.uniformMatrix4fv(l.B[y.name],
!1,y.value)}})},Pg:function(){return"lowp"},m:function(){b.disableVertexAttribArray(0);M.R();for(var u in z){var f=z[u];f.qa&&(f.qa=!1,b.deleteProgram(f.ra));f.ff&&delete z[u]}q.forEach(function(y){b.deleteShader(y)});q.splice(0);v=0;C=!1;l=null;r=-1}};return M}(),b=null,Qa=function(){function a(g){console.log("ERROR in ContextFF: ",g);return!1}function c(g){function t(){Ca.m();ba.reset();k.getExtension("WEBGL_lose_context").loseContext()}if(navigator.userAgent&&-1!==navigator.userAgent.indexOf("forceWebGL1"))return!1;
var x=document.createElement("canvas");x.setAttribute("width",5);x.setAttribute("height",5);var k=null;try{k=x.getContext("webgl2",g)}catch(p){return!1}if(!k)return!1;d(k);ba.bd(k);g=ba.Lb(k);if(!g.ja&&!g.ka)return t(),!1;g=Ca.Tc(k,g);t();return g?!0:!1}function d(g){g.clearColor(0,0,0,0);g.disable(g.DEPTH_TEST);g.disable(g.BLEND);g.disable(g.DITHER);g.disable(g.STENCIL_TEST);g.disable(g.CULL_FACE);g.GENERATE_MIPMAP_HINT&&g.hint(g.GENERATE_MIPMAP_HINT,g.FASTEST);g.disable(g.SAMPLE_ALPHA_TO_COVERAGE);
g.disable(g.SAMPLE_COVERAGE);g.depthFunc(g.LEQUAL);g.clearDepth(1)}var e=null,m=null,n=null,q=null,r=!0,l=null,v=null,C=[],E={F:function(){return e.width},U:function(){return e.height},Gg:function(){return e},Eg:function(){return b},la:function(){return r},flush:function(){b.flush()},Qe:function(){l||(l=new Uint8Array(e.width*e.height*4));b.readPixels(0,0,e.width,e.height,b.RGBA,b.UNSIGNED_BYTE,l);return l},Ig:function(){return e.toDataURL("image/jpeg")},Jg:function(){va.P();m||(m=document.createElement("canvas"),
n=m.getContext("2d"));m.width=e.width;m.height=e.height;for(var g=E.Qe(),t=n.createImageData(m.width,m.height),x=m.width,k=m.height,p=t.data,H=0;H<k;++H)for(var I=k-H-1,N=0;N<x;++N){var z=4*(H*x+N),J=4*(I*x+N);p[z]=g[J];p[z+1]=g[J+1];p[z+2]=g[J+2];p[z+3]=g[J+3]}n.putImageData(t,0,0);return m.toDataURL("image/png")},Hg:function(g){!m&&g&&(m=document.createElement("canvas"),n=m.getContext("2d"));var t=g?m:document.createElement("canvas");t.width=e.width;t.height=e.height;(g?n:t.getContext("2d")).drawImage(e,
0,0);return t},A:function(g){g.De&&!g.Jb?e=document.getElementById(g.De):g.Jb&&(e=g.Jb);e||(e=document.createElement("canvas"));e.width=g&&void 0!==g.width?g.width:512;e.height=g&&void 0!==g.height?g.height:512;"undefined"===typeof g&&(g={});void 0===g.premultipliedAlpha&&(g.premultipliedAlpha=!1);void 0===g.wd&&(g.wd=!0);void 0===g.antialias&&(g.antialias=!1);if(b)r=b instanceof WebGL2RenderingContext;else{r=!0;var t={antialias:g.antialias,alpha:!0,preserveDrawingBuffer:!0,premultipliedAlpha:g.premultipliedAlpha,
stencil:!1,depth:g.wd};navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("noAntialiasing")&&(t.antialias=!1);var x=c(t);!x&&t.antialias&&(t.antialias=!1,x=c(t));x&&(b=e.getContext("webgl2",t));b?r=!0:((b=e.getContext("webgl",t))||(b=e.getContext("experimental-webgl",t)),r=!1)}if(!b)return a("WebGL1 and 2 are not enabled");(q=b.getExtension("WEBGL_lose_context"))&&g.Md&&(v=g.Md,e.addEventListener("webglcontextlost",v,!1));if(!ba.A())return a("Not enough GL capabilities");d(b);B.A();
U.A();if(!Ca.Tc(b,ba.Pe()))return a("Cannot filter float textures");C.forEach(function(k){k(b)});C.splice(0);return!0},$f:function(){return new Promise(function(g){b?g(b):C.push(g)})},m:function(){b&&(ba.m(),Ca.m());q&&v&&(e.removeEventListener("webglcontextlost",v,!1),q=v=null);b=l=n=m=e=null;C.splice(0)}};return E}(),xa=function(){function a(){null===c&&("undefined"!==typeof B?c=B:"undefined"!==typeof JEShaders&&(c=JEShaders))}var c=null;a();return{Ff:function(d){c!==d&&(c&&c.R(),c=d)},mb:function(){return c.mb()},
Aa:function(){return c.Aa()},zb:function(d){return c.zb(d)},yc:function(){return c.yc()},R:function(){return c.R()},set:function(d){return c.set(d)},Qa:function(d){a();return c.Qa(d)},wc:function(d){a();return c.wc(d)},m:function(){return c.m()}}}(),Ba=function(){function a(h){b.bindTexture(b.TEXTURE_2D,h)}function c(h){f[0]=h;h=y[0];var F=h>>16&32768,K=h>>12&2047,P=h>>23&255;return 103>P?F:142<P?F|31744|((255==P?0:1)&&h&8388607):113>P?(K|=2048,F|(K>>114-P)+(K>>113-P&1)):F=(F|P-112<<10|K>>1)+(K&1)}
function d(h){var F=new Uint16Array(h.length);h.forEach(function(K,P){F[P]=c(K)});return F}function e(){if(null!==G.$b)return G.$b;var h=n(d([.5,.5,.5,.5]));return null===h?!0:G.$b=h}function m(){if(null!==G.ac)return G.ac;var h=n(new Uint8Array([127,127,127,127]));return null===h?!0:G.ac=h}function n(h){if(!xa.mb()||!k)return null;var F=null,K=Math.sqrt(h.length/4);try{var P=b.getError();if("FUCKING_BIG_ERROR"===P)return!1;F=L.instance({isFloat:!1,S:!0,array:h,width:K});P=b.getError();if(P!==b.NO_ERROR)return!1}catch(ra){return!1}la.P();
b.viewport(0,0,K,K);b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);xa.set("s0");F.Rc(0);ma.l(!0,!0);h=4*K*K;P=new Uint8Array(h);b.readPixels(0,0,K,K,b.RGBA,b.UNSIGNED_BYTE,P);K=!0;for(var da=0;da<h;++da)K=K&&3>Math.abs(P[da]-127);F.remove();la.ha();return K}var q=0,r=null,l=0,v=null,C=null,E=null,g=null,t=null,x=null,k=!1,p=[],H={isFloat:!1,isPot:!0,isLinear:!1,isMipmap:!1,isAnisotropicFiltering:!1,isMirrorX:!1,isMirrorY:!1,isSrgb:!1,isKeepArray:!1,isFlipY:null,width:0,height:0,url:null,array:null,
data:null,I:null,Zb:null,ef:!1,S:!1,oa:null,rb:4,ic:0},I=!1,N=null,z=null,J=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],M=!1,u=!1,f=new Float32Array(1),y=new Int32Array(f.buffer),G={$b:null,ac:null},L={A:function(){k||(t=[b.RGBA,null,b.RGBA,b.RGBA],x=[b.RGBA,null,b.RGBA,b.RGBA],r=[b.TEXTURE0,b.TEXTURE1,b.TEXTURE2,b.TEXTURE3,b.TEXTURE4,b.TEXTURE5,b.TEXTURE6,b.TEXTURE7],M="undefined"!==typeof JEContext,u="undefined"!==typeof ba,M&&JEContext.gh()&&r.push(b.TEXTURE8,b.TEXTURE9),v=[-1,-1,-1,-1,-1,-1,-1,
-1],g=[b.UNSIGNED_BYTE,b.FLOAT,b.FLOAT],k=!0)},bf:function(){if(!C){for(var h=new Float32Array(16384),F=0;16384>F;++F)h[F]=2*Math.random()-1;C={random:L.instance({isFloat:!0,isPot:!0,array:h,width:64}),ee:L.instance({isFloat:!1,isPot:!0,width:1,array:new Uint8Array([0,0,0,0])})}}L.Sf()},Xg:function(){return C.ee},Sf:function(){g[1]=ba.Vb(b)},Df:function(){x=t=[b.RGBA,b.RGBA,b.RGBA,b.RGBA]},Td:function(h){B.set("s1");la.P();var F=h.F(),K=h.U();b.viewport(0,0,F,K);h.g(0);ma.l(!1,!1)},mh:function(h,
F){L.Td(h);b.readPixels(0,0,h.F(),h.U(),b.RGBA,b.UNSIGNED_BYTE,F)},nh:function(h,F){L.Td(h);return ba.xb(0,0,h.F(),h.U(),F)},kd:function(h,F,K,P,da,ra,za){h.activeTexture(h.TEXTURE0);var w=h.createTexture();h.bindTexture(h.TEXTURE_2D,w);da=da instanceof Float32Array?da:new Float32Array(da);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST);h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_MIN_FILTER,h.NEAREST);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,ra);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,K,P,0,h.RGBA,h.FLOAT,da);h.bindTexture(h.TEXTURE_2D,null);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!1);za&&(la.ha(),B.Qa(h));h.viewport(0,0,K,P);h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,F,0);h.bindTexture(h.TEXTURE_2D,w);za?ma.l(!0,!0):U.$a(h);h.deleteTexture(w);k&&(v[0]=-1,E=null,q=0)},Fb:function(h){h!==q&&(b.activeTexture(r[h]),q=h)},instance:function(h){function F(){R=
void 0!==w.I.videoWidth?w.I.videoWidth:w.I.width;T=void 0!==w.I.videoHeight?w.I.videoHeight:w.I.height}function K(D){var S=b.getError();if("FUCKING_BIG_ERROR"===S)return!1;b.texImage2D(b.TEXTURE_2D,0,ia,ea,fa,D);S=b.getError();S!==b.NO_ERROR&&ea!==b.RGBA&&(ea=b.RGBA,b.texImage2D(b.TEXTURE_2D,0,ia,ea,fa,D));return!0}function P(){if(!Ab){a(ta);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,Aa);w.isPot?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,w.isMirrorX?b.MIRRORED_REPEAT:b.REPEAT),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_WRAP_T,w.isMirrorY?b.MIRRORED_REPEAT:b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE));w.isAnisotropicFiltering&&"undefined"!==typeof JESETTINGS&&b.texParameterf(b.TEXTURE_2D,JEContext.Kg().TEXTURE_MAX_ANISOTROPY_EXT,JESETTINGS.Wf);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,w.isLinear?b.LINEAR:b.NEAREST);w.isLinear?b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,w.isMipmap&&!Ka?b.NEAREST_MIPMAP_LINEAR:
b.LINEAR):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,w.isMipmap&&!Ka?b.NEAREST_MIPMAP_NEAREST:b.NEAREST);ea=t[w.rb-1];ia=x[w.rb-1];fa=g[nb];if(ba.la()){var D=ba.Se();ea===b.RGBA&&fa===b.FLOAT?w.isMipmap||w.isLinear?ia=Ca.Ue(b):ba.Uc()?D&&(ia=D):ia=b.RGBA16F||b.RGBA:ea===b.RGB&&fa===b.FLOAT&&D&&(ia=D,ea=b.RGBA)}if(w.S&&!w.isFloat||w.isFloat&&w.isMipmap&&Ca.jf())ia=ba.Te(),fa=ba.Vb(b);w.ic&&(ab=w.ic);w.isSrgb&&4===w.rb&&(ea=JEContext.Vg());if(w.I)K(w.I);else if(w.url)K(Ga);else if(ua){D=ua;try{"FUCKING_BIG_ERROR"!==
b.getError()&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,D),b.getError()!==b.NO_ERROR&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,null),b.getError()!==b.NO_ERROR&&b.texImage2D(b.TEXTURE_2D,0,b.RGBA,R,T,0,b.RGBA,b.UNSIGNED_BYTE,null)))}catch(gc){b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,null)}w.isKeepArray||(ua=null)}else D=b.getError(),"FUCKING_BIG_ERROR"!==D&&(b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,null),D=b.getError(),D!==b.NO_ERROR&&(ea=b.RGBA,w.S&&fa!==b.FLOAT&&(fa=b.FLOAT,b.texImage2D(b.TEXTURE_2D,
0,ia,R,T,0,ea,fa,null))));if(w.isMipmap)if(!Ka&&ca)ca.Ub(),bb=!0;else if(Ka){D=Math.log2(Math.min(R,T));Ra=Array(1+D);Ra[0]=ta;for(var S=1;S<=D;++S){var ka=Math.pow(2,S),V=R/ka;ka=T/ka;var La=b.createTexture();a(La);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texImage2D(b.TEXTURE_2D,0,ia,V,ka,0,ea,fa,null);a(null);Ra[S]=La}bb=!0}a(null);v[q]=-1;Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);Ta=!0;w.oa&&ca&&(w.oa(ca),w.oa=
null)}}function da(){for(var D=R*T,S=2*D,ka=3*D,V=0;V<D;++V)ya[0][V]=Ua[V],ya[1][V]=Ua[V+D],ya[2][V]=Ua[V+S],ya[3][V]=Ua[V+ka]}function ra(){var D=R*T*4;Da=[new Uint8Array(D),new Uint8Array(D),new Uint8Array(D),new Uint8Array(D)];ya=[new Float32Array(Da[0].buffer),new Float32Array(Da[1].buffer),new Float32Array(Da[2].buffer),new Float32Array(Da[3].buffer)];cb=new Uint8Array(4*D);Ua=new Float32Array(cb.buffer);Va=!0}function za(){Ea.Gb=new Uint8Array(R*T*4);Ea.ld=new Float32Array(Ea.buffer);Ea.Y=!0}
var w=Object.assign({},H,h),Wa=l++;null===w.isFlipY&&(w.isFlipY=w.url||w.array?!0:!1);w.data&&(w.array="string"===typeof w.data?Ib(w.data):w.isFloat?new Float32Array(w.data):new Uint8Array(w.data),w.isFlipY=!1);var nb=0,Bb=w.I?!0:!1,Xa=null,ob=null,Cb=!1,pb=null;w.S=w.S||w.isFloat;w.S&&(nb=1);!w.ef&&w.isFloat&&u&&!ba.Uc()&&(w.isFloat=!1);w.isFloat&&(nb=2);w.isAnisotropicFiltering&&M&&!JEContext.$g()&&(w.isAnisotropicFiltering=!1);var ta=w.Zb||b.createTexture(),Ga=null,ua=!1,R=0,T=0,Ta=!1,Ab=!1,Va=
!1,ya=null,Da=null,cb=null,Ua=null,ia=null,ea=null,fa=null,Aa=w.isFlipY,Vb=(h=w.S&&w.isMipmap)&&Ca.ue(),Ka=h&&Vb?!0:!1,Ra=null,ab=-1,bb=!1,Ea={Y:!1,Gb:null,ld:null};w.width&&(R=w.width,T=w.height?w.height:R);var ca={get:function(){return ta},F:function(){return R},U:function(){return T},Yg:function(){return w.url},ah:function(){return w.isFloat},dh:function(){return w.S},eh:function(){return w.isLinear},Ub:function(){b.generateMipmap(b.TEXTURE_2D)},se:function(D,S){Ka?(D||(D=ca.pd()),L.Fb(S),a(Ra[D]),
v[S]=-1):ca.g(S)},pd:function(){-1===ab&&(ab=Math.log(R)/Math.log(2));return ab},Me:function(D){if(Ka){D||(D=ca.pd());B.set("s11");L.Fb(0);for(var S=R,ka=T,V=1;V<=D;++V)S/=2,ka/=2,B.sa("u7",.25/S,.25/ka),b.viewport(0,0,S,ka),a(Ra[V-1]),b.framebufferTexture2D(la.cb(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,Ra[V],0),ma.l(!1,1===V);v[0]=-1}else ca.Ub()},vh:function(D){(Bb=!Tb.Mf(D))?(ua=null,w.I=D,F()):ua=D},g:function(D){if(!Ta)return!1;L.Fb(D);if(v[D]===Wa)return!1;a(ta);v[D]=Wa;return!0},Rc:function(D){b.activeTexture(r[D]);
q=D;a(ta);v[D]=Wa},u:function(){E=ca;b.framebufferTexture2D(la.cb(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,ta,0)},da:function(){E=ca;b.viewport(0,0,R,T);b.framebufferTexture2D(la.cb(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,ta,0)},Fc:L.Fc,resize:function(D,S){R=D;T=S;P()},clone:function(D){D=L.instance({width:R,height:T,S:w.S,isFloat:w.isFloat,isLinear:w.isLinear,isMirrorY:w.isMirrorY,isFlipY:D?!Aa:Aa,isPot:w.isPot});xa.set("s0");la.ha();D.u();b.viewport(0,0,R,T);ca.g(0);ma.l(!0,!0);return D},Hf:function(){b.viewport(0,
0,R,T)},remove:function(){b.deleteTexture(ta);Ab=!0;p.splice(p.indexOf(ca),1);ca=null},refresh:function(){ca.Rc(0);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);Bb?b.texImage2D(b.TEXTURE_2D,0,ia,ea,fa,w.I):b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,ua);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Sd:function(){Va||ra();b.readPixels(0,0,R,4*T,b.RGBA,b.UNSIGNED_BYTE,cb);da();return ya},xf:function(){Va||ra();return ba.xb(0,0,R,4*T,cb).then(function(){da();return ya})},zf:function(){Ea.Y||za();b.readPixels(0,
0,R,T,b.RGBA,b.UNSIGNED_BYTE,Ea.Gb);return Ea.ld},yf:function(){Ea.Y||za();return ba.xb(0,0,R,T,Ea.Gb)},Zc:function(D){la.P();B.set("s12");ca.g(0);if(D)b.viewport(0,0,R,T),B.xc("u8",.25,.25,.25,.25),ma.l(!1,!0);else for(D=0;4>D;++D)b.viewport(0,T*D,R,T),B.xc("u8",J[D]),ma.l(!1,0===D)},Rf:function(D){var S=fa===g[0]&&!m();a(ta);Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);S?(Cb||(Xa=document.createElement("canvas"),Xa.width=R,Xa.height=T,ob=Xa.getContext("2d"),pb=ob.createImageData(R,T),Cb=!0),pb.data.set(D),
ob.putImageData(pb,0,0),b.texImage2D(b.TEXTURE_2D,0,ia,ea,fa,Xa)):b.texImage2D(b.TEXTURE_2D,0,ia,R,T,0,ea,fa,D);v[q]=Wa;Aa&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},Gh:function(D,S){a(ta);S&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);b.texImage2D(b.TEXTURE_2D,0,ia,ea,fa,D);v[q]=Wa;S&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1)},th:function(D,S){var ka=R*T,V=4*ka;D=w.S?D?"RGBE":"JSON":"RGBA";S&&(D=S);S=ba.la()&&!1;var La=null;switch(D){case "RGBE":La="s42";break;case "JSON":La=S?"s0":"s12";break;case "RGBA":case "RGBAARRAY":La=
"s6"}Va||("RGBA"===D||"RGBE"===D||"RGBAARRAY"===D?(Da=new Uint8Array(V),Va=!0):"JSON"!==D||S||ra());la.P();B.set(La);ca.g(0);V=null;if("RGBA"===D||"RGBE"===D||"RGBAARRAY"===D){b.viewport(0,0,R,T);ma.l(!0,!0);b.readPixels(0,0,R,T,b.RGBA,b.UNSIGNED_BYTE,Da);if("RGBAARRAY"===D)return{data:Da};I||(N=document.createElement("canvas"),z=N.getContext("2d"),I=!0);N.width=R;N.height=T;ka=z.createImageData(R,T);ka.data.set(Da);z.putImageData(ka,0,0);V=N.toDataURL("image/png")}else if("JSON"===D)if(S)V=new Float32Array(ka),
b.viewport(0,0,R,T),ma.l(!0,!0),b.readPixels(0,0,R,T,b.RGBA,b.FLOAT,V);else{for(V=0;4>V;++V)b.viewport(0,T*V,R,T),B.xc("u8",J[V]),ma.l(!V,!V);ca.Sd();V=Array(ka);for(S=0;S<ka;++S)V[4*S]=ya[0][S],V[4*S+1]=ya[1][S],V[4*S+2]=ya[2][S],V[4*S+3]=ya[3][S]}return{format:D,data:V,width:R,height:T,isMirrorY:w.isMirrorY,isFlipY:"RGBA"===D?w.isFlipY:!w.isFlipY}}};w.isMipmap&&!Ka&&Ta&&!bb&&(ca.Ub(),bb=!0);if(w.url)a(ta),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,null),Ga=new Image,Ga.jg="Anonymous",
Ga.crossOrigin="Anonymous",Ga.src=w.url,Ga.onload=function(){R=Ga.width;T=Ga.height;P()};else if(w.I){var Db=function(){F();R?P():setTimeout(Db,1)};Db()}else w.array?(w.S&&!w.isFloat?w.array instanceof Uint16Array?(ua=w.array,P()):e()?(ua=d(w.array),P()):(P(),L.kd(b,ta,ca.F(),ca.U(),w.array,Aa,!0)):(ua=w.isFloat?w.array instanceof Float32Array?w.array:new Float32Array(w.array):w.array instanceof Uint8Array?w.array:new Uint8Array(w.array),P()),w.isKeepArray||(ua&&ua!==w.array&&(ua=null),delete w.array)):
w.Zb?Ta=!0:P();ca.Ug=ca.F;w.oa&&Ta&&(w.oa(ca),w.oa=null);p.push(ca);return ca},P:function(h){h!==q&&(b.activeTexture(r[h]),q=h);v[h]=-1;a(null)},Zf:function(h){C.random.g(h)},Fc:function(){E=null;b.framebufferTexture2D(la.cb(),b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0)},reset:function(){0!==q&&b.activeTexture(r[0]);for(var h=0;h<r.length;++h)v[h]=-1;q=-1},qh:function(){q=-1},Of:function(){for(var h=0;h<r.length;++h)L.P(h)},md:function(){C&&(C.random.remove(),C.ee.remove())},Fh:function(h,F){if("RGBA"===
h.format||"RGBE"===h.format){var K=new Image;K.src=h.data;K.onload=function(){L.instance({isMirrorY:h.isMirrorY,isFlipY:h.isFlipY,isFloat:!1,I:K,oa:function(P){if("RGBA"===h.format)F(P);else{var da=h.width,ra=h.height,za=L.instance({isMirrorY:h.isMirrorY,isFloat:!0,width:da,height:ra,isFlipY:h.isFlipY});la.ha();b.viewport(0,0,da,ra);B.set("s43");za.u();P.g(0);ma.l(!0,!0);L.P(0);F(za);b.flush();setTimeout(P.remove,50)}}})}}else"JSON"===h.format?F(L.instance({isFloat:!0,isFlipY:h.isFlipY,width:h.width,
height:h.height,array:new Float32Array(h.data)})):F(!1)},Ae:d,m:function(){E&&(va.ha(),L.Fc(),va.P());L.Of();p.slice(0).forEach(function(h){h.remove()});p.splice(0);k=!1;l=0;"undefined"!==typeof Ca&&Ca.m();C=null}};return L}(),Nb=function(){return{instance:function(a){var c=[Ba.instance(a),Ba.instance(a)],d=[c[1],c[0]],e=d,m={Bf:function(n){e[1].u();e[0].g(n);m.$d()},uh:function(n){e[1].da();e[0].g(n);m.$d()},$d:function(){e=e===c?d:c},refresh:function(){e[0].refresh();e[1].refresh()},g:function(n){e[0].g(n)},
Yf:function(n){e[1].g(n)},Og:function(){return e[0]},Sg:function(){return e[1]},remove:function(){e[0].remove();e[1].remove();e=null}};return m}}}(),ma=function(){function a(l){var v={ea:null,K:null};v.ea=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,v.ea);l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),l.STATIC_DRAW);v.K=l.createBuffer();l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,v.K);l.bufferData(l.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2]),l.STATIC_DRAW);return v}var c=null,d=0,e=!1,
m=[],n=-2,q=-2,r={reset:function(){q=n=-2},A:function(){e||(c=a(b),r.Ia(),e=!0)},instance:function(l){var v=d++,C=l.K?l.K.length:0,E="undefined"===typeof l.mode?b.STATIC_DRAW:l.mode,g=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,l.ea instanceof Float32Array?l.ea:new Float32Array(l.ea),E);n=v;var t=null,x=null,k=null;if(l.K){t=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,t);var p=null;65536>l.K.length?(p=Uint16Array,x=b.UNSIGNED_SHORT,k=2):(p=Uint32Array,x=b.UNSIGNED_INT,
k=4);p=l.K instanceof p?l.K:new p(l.K);b.bufferData(b.ELEMENT_ARRAY_BUFFER,p,E);q=v}var H={te:function(I){n!==v&&(b.bindBuffer(b.ARRAY_BUFFER,g),n=v);I&&xa.yc()},qe:function(){q!==v&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,t),q=v)},bind:function(I){H.te(I);H.qe()},lg:function(){b.drawElements(b.TRIANGLES,C,x,0)},mg:function(I,N){b.drawElements(b.TRIANGLES,I,x,N*k)},remove:function(){b.deleteBuffer(g);l.K&&b.deleteBuffer(t);H=null}};m.push(H);return H},Ia:function(){-1!==n&&(b.bindBuffer(b.ARRAY_BUFFER,
c.ea),n=-1);-1!==q&&(b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.K),q=-1)},l:function(l,v){l&&ma.Ia();v&&xa.Aa();b.drawElements(b.TRIANGLES,3,b.UNSIGNED_SHORT,0)},$a:function(l){l=l||b;var v=a(l);l.bindBuffer(l.ARRAY_BUFFER,v.ea);l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,v.K);xa.zb(l);l.clear(l.COLOR_BUFFER_BIT);l.drawElements(l.TRIANGLES,3,l.UNSIGNED_SHORT,0);l.flush();l.bindBuffer(l.ARRAY_BUFFER,null);l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null);l.deleteBuffer(v.ea);l.deleteBuffer(v.K);r.reset();e&&(r.Ia(),xa.Aa())},
md:function(){var l=b,v=c;l.deleteBuffer(v.ea);l.deleteBuffer(v.K)},m:function(){r.md();m.forEach(function(l){l.remove()});b.bindBuffer(b.ARRAY_BUFFER,null);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);r.reset();e=!1;m.splice(0);d=0}};return r}(),la=function(){var a=null,c=null,d=null,e=!1,m=[],n={J:-2,jd:1},q={mb:function(){return e},A:function(){if(!e){a=b.createFramebuffer();var r=ba.la();c=r&&b.DRAW_FRAMEBUFFER?b.DRAW_FRAMEBUFFER:b.FRAMEBUFFER;d=r&&b.READ_FRAMEBUFFER?b.READ_FRAMEBUFFER:b.FRAMEBUFFER;
e=!0}},Lg:function(){return c},Ve:function(){return d},cb:function(){return b.FRAMEBUFFER},Tg:function(){return n},Dg:function(){return a},instance:function(r){void 0===r.vd&&(r.vd=!1);var l=r.N?r.N:null,v=r.width,C=void 0!==r.height?r.height:r.width,E=a,g=null,t=!1,x=!1,k=0;l&&(v=v?v:l.F(),C=C?C:l.U());var p={Xd:function(){t||(E=b.createFramebuffer(),t=!0,k=n.jd++)},ke:function(){p.Xd();p.u();g=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,g);b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,
v,C);b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,g);b.clearDepth(1)},bind:function(H,I){k!==n.J&&(b.bindFramebuffer(c,E),n.J=k);l&&l.u();I&&b.viewport(0,0,v,C);H&&b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},Xf:function(){k!==n.J&&(b.bindFramebuffer(c,E),n.J=k)},clear:function(){b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT)},fg:function(){b.clear(b.COLOR_BUFFER_BIT)},gg:function(){b.clear(b.DEPTH_BUFFER_BIT)},Hf:function(){b.viewport(0,0,v,C)},u:function(){k!==n.J&&(b.bindFramebuffer(c,
E),n.J=k)},rtt:function(H){l=H;n.J!==k&&(b.bindFramebuffer(b.FRAMEBUFFER,E),n.J=k);H.u()},P:function(){b.bindFramebuffer(c,null);n.J=-1},resize:function(H,I){v=H;C=I;g&&(b.bindRenderbuffer(b.RENDERBUFFER,g),b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,v,C))},remove:function(){E===a||x||(b.bindFramebuffer(c,E),b.framebufferTexture2D(c,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),g&&b.framebufferRenderbuffer(c,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,null),b.bindFramebuffer(c,null),b.deleteFramebuffer(E),
g&&b.deleteRenderbuffer(g));x=!0}};r.vd&&p.ke();m.push(p);return p},P:function(){b.bindFramebuffer(c,null);n.J=-1},Pf:function(){b.bindFramebuffer(c,null);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);b.viewport(0,0,ba.F(),ba.U());n.J=-1},reset:function(){n.J=-2},ha:function(){0!==n.J&&(b.bindFramebuffer(c,a),n.J=0)},clear:function(){b.viewport(0,0,ba.F(),ba.U());b.clear(b.COLOR_BUFFER_BIT)},m:function(){q.P();m.forEach(function(r){r.remove()});null!==a&&(b.deleteFramebuffer(a),a=null);q.reset();
e=!1;m.splice(0);n.jd=1}};return q}(),ba=function(){function a(){e="undefined"===typeof Qa?JEContext:Qa;m=!0}function c(k,p){for(var H=0;H<k.length;++H){var I=p.getExtension(k[H]);if(I)return I}return null}function d(){null!==g.Cb&&(clearInterval(g.Cb),g.Cb=null);g.Na=!1}var e=null,m=!1,n={xd:!1,Ac:null,Bc:null,Bd:!1,hf:!1,Cc:null,Cd:!1,Dc:null,yd:!1,Hb:null,cf:!1,Ib:null,df:!1},q=null,r={ja:!0,ka:!0,Tb:!0,Rd:!1},l=null,v=!0,C=null,E=null,g={Na:!1,va:null,hb:null,Yb:-1,X:null,Cb:null},t="undefined"===
typeof window?{}:window,x={A:function(){if(m)return!0;x.reset();m||a();var k=b;if(!q.xd){q.Ac=x.ed(k);t.GL_EXT_FLOAT=q.Ac;q.Bd=q.Ac?!0:!1;if(q.Bd||x.la())q.Bc=x.fd(k),q.hf=q.Bc?!0:!1,t.GL_EXT_FLOATLINEAR=q.Bc;q.xd=!0}if(!q.yd){q.Cc=x.Ya(k);q.Cc&&(q.Cd=!0,t.GL_EXT_HALFFLOAT=q.Cc);if(q.Cd||x.la())q.Dc=x.gd(k),t.GL_EXT_HALFFLOATLINEAR=q.Dc;q.Zg=q.Dc?!0:!1;q.yd=!0}q.Hb=x.cd(k);q.cf=q.Hb?!0:!1;t.GL_EXT_COLORBUFFERFLOAT=q.Hb;q.Ib=x.dd(k);q.df=q.Ib?!0:!1;t.GL_EXT_COLORBUFFERHALFFLOAT=q.Ib;la.A();Ba.A();
if(!x.Ee())return!1;ma.A();Ba.bf();return!0},reset:function(){q=Object.assign({},n);l=Object.assign({},r)},F:function(){m||a();return e.F()},U:function(){m||a();return e.U()},la:function(){m||a();return e.la()},bd:function(k){x.cd(k);x.dd(k);x.ed(k);x.fd(k);x.Ya(k);x.gd(k)},cd:c.bind(null,["EXT_color_buffer_float","WEBGL_color_buffer_float","OES_color_buffer_float"]),dd:c.bind(null,["EXT_color_buffer_half_float","WEBGL_color_buffer_half_float","OES_color_buffer_half_float"]),ed:c.bind(null,["OES_texture_float",
"MOZ_OES_texture_float","WEBKIT_OES_texture_float"]),fd:c.bind(null,["OES_texture_float_linear","MOZ_OES_texture_float_linear","WEBKIT_OES_texture_float_linear"]),Ya:c.bind(null,["OES_texture_half_float","MOZ_OES_texture_half_float","WEBKIT_OES_texture_half_float"]),gd:c.bind(null,["OES_texture_half_float_linear","MOZ_OES_texture_half_float_linear","WEBKIT_OES_texture_half_float_linear"]),Vb:function(k){var p=x.Ya(k);return p&&p.HALF_FLOAT_OES?p.HALF_FLOAT_OES:k.HALF_FLOAT||k.FLOAT},Se:function(){return E||
b.RGBA32F||b.RGBA},Te:function(){return C||b.RGBA16F||b.RGBA},Pe:function(){return l},Uc:function(){return l.ja},bg:function(){return l.ka},ag:function(){return l.Tb},ve:function(){return l.Rd&&v},ce:function(k){v=k;!k&&g.Na&&(b.deleteSync(g.hb),b.bindBuffer(g.X,null),g.Na=!1)},Ab:function(k,p,H){function I(){k.bindTexture(k.TEXTURE_2D,null);k.bindFramebuffer(N,null);k.deleteTexture(M);k.deleteFramebuffer(J)}var N=k.FRAMEBUFFER,z=k.NEAREST,J=k.createFramebuffer();k.bindFramebuffer(N,J);var M=k.createTexture();
k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,M);k.pixelStorei(k.UNPACK_FLIP_Y_WEBGL,!1);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,z);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,z);k.texImage2D(k.TEXTURE_2D,0,p,3,3,0,k.RGBA,H,null);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,M,0);if(k.checkFramebufferStatus(k.READ_FRAMEBUFFER||
k.FRAMEBUFFER)!==k.FRAMEBUFFER_COMPLETE)return I(),!1;xa.wc(k);k.clearColor(0,0,0,0);k.viewport(0,0,3,3);k.disable(k.DEPTH_TEST);k.clear(k.COLOR_BUFFER_BIT);ma.$a(k);k.bindFramebuffer(N,null);xa.Qa(k);k.activeTexture(k.TEXTURE0);k.bindTexture(k.TEXTURE_2D,M);ma.$a(k);p=new Uint8Array(36);k.readPixels(0,0,3,3,k.RGBA,k.UNSIGNED_BYTE,p);I();for(H=0;36>H;++H)if(3!==H%4&&3<Math.abs(p[H]-127))return!1;return!0},Lb:function(k){var p={ja:!1,ka:!1};k.disable(k.BLEND);k.clearColor(0,0,0,0);k.clear(k.COLOR_BUFFER_BIT);
k.RGBA32F&&x.Ab(k,k.RGBA32F,k.FLOAT)&&(p.ja=!0,E=k.RGBA32F);!p.ja&&x.Ab(k,k.RGBA,k.FLOAT)&&(p.ja=!0,E=k.RGBA);var H=x.Vb(k);C=null;k.RGBA16F&&x.Ab(k,k.RGBA16F,H)&&(p.ka=!0,C=k.RGBA16F);!p.ka&&x.Ab(k,k.RGBA,H)&&(p.ka=!0,C=k.RGBA);return p},Fe:function(){var k=la.instance({width:2});k.Xd();var p=Ba.instance({width:2,isFloat:!0,rb:3});k.u();p.u();b.flush();b.checkFramebufferStatus(la.Ve())!==b.FRAMEBUFFER_COMPLETE?(Ba.Df(),l.Tb=!1):l.Tb=!0;k.remove();p.remove()},Ge:function(){var k=!1;x.la()&&(k="PIXEL_PACK_BUFFER STREAM_READ SYNC_GPU_COMMANDS_COMPLETE WAIT_FAILED fenceSync deleteSync createBuffer".split(" ").every(function(p){return"undefined"!==
typeof b[p]}));l.Rd=k},Ee:function(){var k=x.Lb(b);Object.assign(l,k);if(!l.ja&&!l.ka)return!1;x.Fe();x.Ge();return!0},xb:function(k,p,H,I,N){if(!x.ve())return b.readPixels(k,p,H,I,b.RGBA,b.UNSIGNED_BYTE,N),Promise.resolve(N);null===g.va&&(g.X=b.PIXEL_PACK_BUFFER,g.va=b.createBuffer(),g.Yb=-1);b.bindBuffer(g.X,g.va);N.byteLength!==g.Yb&&(b.bufferData(g.X,N.byteLength,b.STREAM_READ),g.Yb=N.byteLength);b.readPixels(k,p,H,I,b.RGBA,b.UNSIGNED_BYTE,0);g.hb=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);b.flush();
return new Promise(function(z,J){function M(){if(!g.Na)return d(),J(),!1;switch(b.clientWaitSync(g.hb,0,0)){case b.TIMEOUT_EXPIRED:case b.WAIT_FAILED:return!1;default:return d(),b.deleteSync(g.hb),b.getBufferSubData(g.X,0,N),b.bindBuffer(g.X,null),z(N),!0}}d();g.Na=!0;M()||(g.Cb=setInterval(M,0))})},m:function(){d();Ba.m();xa.m();la.m();ma.m();null!==g.va&&(b.deleteBuffer(g.va),g.va=null);m=!1}};return x}(),U=ma,va=la,Y=Ba,Ca=function(){function a(J,M,u,f){p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,
f?p.NEAREST_MIPMAP_NEAREST:p.LINEAR);var y=null;if(null!==u)try{y=p.getError();if("FUCKING_BIG_ERROR"===y)return!1;p.texImage2D(p.TEXTURE_2D,0,J,4,4,0,p.RGBA,M,u);y=p.getError();if(y!==p.NO_ERROR)return!1}catch(G){return!1}f&&p.generateMipmap(p.TEXTURE_2D);p.clear(p.COLOR_BUFFER_BIT);U.$a(p);y=p.getError();if("FUCKING_BIG_ERROR"===y)return!1;p.readPixels(0,0,2,2,p.RGBA,p.UNSIGNED_BYTE,C);y=p.getError();y===p.INVALID_OPERATION&&"undefined"!==typeof p.PIXEL_PACK_BUFFER&&(p.bindBuffer(p.PIXEL_PACK_BUFFER,
null),p.readPixels(0,0,2,2,p.RGBA,p.UNSIGNED_BYTE,C),y=p.getError());if(y!==p.NO_ERROR)return!1;u=!0;for(f=0;16>f;++f)u=u&&4>Math.abs(C[f]-127);u&&(l.Od=M,l.ud=J);return u}function c(J,M){return H.ja&&a(J,p.FLOAT,new Float32Array(E),M)?(r=q.Nc,!0):!1}function d(J,M,u){if(!H.ka)return!1;var f=Ba.Ae(E),y=ba.Ya(p);if(y&&y.HALF_FLOAT_OES&&a(J,y.HALF_FLOAT_OES,f,M)||p.HALF_FLOAT&&a(J,p.HALF_FLOAT,f,M))return r=q.Fa,!0;f=new Float32Array(E);if(a(J,p.FLOAT,f,M))return r=q.Fa,!0;p.bindTexture(p.TEXTURE_2D,
u);p.texImage2D(p.TEXTURE_2D,0,p.RGBA,2,2,0,p.RGBA,p.UNSIGNED_BYTE,null);p.bindFramebuffer(l.Wa,z);Ba.kd(p,u,2,2,f,!1,!1);p.bindFramebuffer(l.Wa,null);p.bindTexture(p.TEXTURE_2D,u);return a(J,null,null,M)?(r=q.Fa,!0):!1}function e(J,M,u){v=!0;if(d(J,!0,u)||c(M,!0))return!0;v=!1;return d(J,!1,u)||c(M,!1)?!0:!1}function m(J){if(r===q.R){p=J||b;r=q.RGBA8;v=!0;ba.bd(p);H||(H=ba.Lb(p));va.reset();z=p.createFramebuffer();l.Wa=p.DRAW_FRAMEBUFFER||p.FRAMEBUFFER;p.bindFramebuffer(l.Wa,null);p.clearColor(0,
0,0,0);p.viewport(0,0,2,2);B.R();I=B.Qa(p);J=p.createTexture();p.activeTexture(p.TEXTURE0);p.bindTexture(p.TEXTURE_2D,J);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT);p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST);N=J;var M=J=p.RGBA,u=p.RGBA16F,f=p.RGBA32F;f&&(J=f);u&&(M=u);if((u||f)&&e(M,J,N))return n(),!0;J=M=p.RGBA;if(e(M,J,N))return n(),!0;r=q.RGBA8;n();return!1}}function n(){p.deleteProgram(I.ra);p.deleteTexture(N);
N=I=null}for(var q={R:-1,Nc:3,Fa:2,RGBA8:0},r=q.R,l={Od:null,ud:null,Wa:null},v=!0,C=new Uint8Array(16),E=Array(64),g=0;4>g;++g)for(var t=0;4>t;++t){var x=0===(t+g)%2?1:0,k=4*g+t;E[4*k]=x;E[4*k+1]=x;E[4*k+2]=x;E[4*k+3]=x}var p=null,H=null,I=null,N=null,z=null;return{ue:function(J){m(J);return v},Tc:function(J,M){r===q.R&&(typeof("undefined"!==M)&&(H=M),m(J));return r!==q.RGBA8},bh:function(J){m(J);return r===q.Nc},jf:function(J){m(J);return r===q.Fa},Mg:function(J){m(J);return l.Od},Ue:function(J){m(J);
return l.ud},m:function(){p=null;v=!0;r=q.R;H=null}}}(),Wb=function(){return{instance:function(a){var c=Y.instance(a.alpha),d=Y.instance(a.beta);return{Ie:function(){c.g(1);d.g(2)}}}}}(),Gb=function(){return{instance:function(a){var c=null,d=!1,e=!1,m=null,n=!1,q=!1,r=null,l="undefined"===typeof a.preprocessing?!1:a.preprocessing,v="undefined"===typeof a.preprocessingSize?a.size:a.preprocessingSize;a.mask&&(d=!0,aa&&void 0!==aa.pe&&(a.mask=aa.pe+a.mask),c=Y.instance({isFloat:!1,url:a.mask}));var C=
!1;a.customInputShader&&(C="s44",B.Pc({name:"_",id:C,h:a.customInputShader,Eh:["uSource"],precision:"lowp"}),B.T(C,[{type:"1i",name:"_",value:0}]));switch(l){case "sobel":r="s31";n=!0;break;case "meanNormalization":r="s32";n=!0;break;case "grayScale":r="s28";n=!1;break;case "grayScaleTilt":r="s29";q=!0;n=!1;break;case "rgbGrayTilt":r="s30";q=!0;n=!1;break;case "copy":r=C?C:"s0";break;case "inputLightRegulation":r=C?C:"s28";m=Xb.instance({td:v,Nd:a.size,Jd:a.nBlurPass,lb:!1});e=!0;break;case "inputMix0":r=
"none";m=Yb.instance({D:v,fe:a.varianceMin,Sc:a.blurKernelSizePx,lb:!1});e=!0;break;case "direct":case "none":r="abort";break;default:r="s3"}q&&B.T(r,[{name:"u26",type:"1f",value:a.tilt}]);d&&(r+="Mask");var E=Y.instance({isFloat:!1,isPot:!1,width:a.size}),g={F:function(){return v},Wb:function(){return g.F()},Ye:function(){return e?m.Xb():E},V:function(t){va.ha();"abort"!==r&&("none"!==r&&(B.set(r),n&&B.H("u27",1/a.size),E.da(),d&&c.g(1),U.l(!1,!1),E.g(0),t=E),e&&m.process(t))},m:function(){E.remove();
d&&c.remove()}};return g}}}(),Hb=function(){return{instance:function(a){function c(h){m.forEach(function(F,K){n[K][0]=h[0][F];n[K][1]=h[1][F];n[K][2]=h[2][F];n[K][3]=h[3][F]});return n}"undefined"===typeof a.normalize&&(a.normalize=!1);var d={input:null,Ta:null,bc:null,ba:null,tb:null,oc:null,pc:null},e=null,m=[],n=[],q=!1,r=null,l=!0,v=-1,C=a.isReorganize?a.isReorganize:!1,E=a.kernelsCount?!0:!1,g=a.dynPelu?Wb.instance(a.dynPelu):!1,t=g?!0:!1,x={isEnabled:!1};a.gf?(a.sparsity="undefined"!==typeof a.sparsity?
a.sparsity:a.vb.Wb(),l=!1):"full"===a.connectivityUp&&(a.sparsity=a.vb.Wb());var k={elu:"s15",elu01:"s16",relu:"s14",arctan:"s18",sigmoid:"s13",copy:"s0",softplus:"s19",dynPelu:"s17"}[a.activation],p=a.sparsity*a.sparsity,H=!1,I=a.size,N="";if(a.maxPooling){switch(a.maxPooling.size){case 2:N="s33";break;case 4:N="s34"}H=!0;I/=a.maxPooling.size;d.oc=Y.instance({isFloat:!0,isPot:!1,width:I})}var z=void 0!==a.rf&&a.rf?!0:!1,J=null,M=null,u=null;if(z){J="s45"+a.index.toString();B.sd("s45",J,[((a.normalization.n-
1)/2).toFixed(1)]);B.T(J,[{type:"1i",name:"u1",value:0},{type:"2f",name:"u7",value:[1/a.size,1/a.size]},{type:"1f",name:"u6",value:a.normalization.alpha},{type:"1f",name:"u9",value:a.normalization.beta},{type:"1f",name:"u30",value:a.normalization.k}]);var f={isFloat:!0,isPot:!0,width:a.size};M=Y.instance(f);u=Y.instance(f)}var y=-1,G=null;l&&(d.ba=Y.instance({isFloat:!0,isPot:!1,width:a.size}));d.Ta=Y.instance(a.bias);var L={F:function(){return a.size},Wb:function(){return I},nd:function(){return a.classesCount},
re:function(h){e.g(h)},uf:function(){a.remap&&a.remap.isEnabled&&(x={isEnabled:!0,lf:Y.instance({isFloat:!1,isFlipY:!1,array:new Uint8Array(a.remap.maskTexture.data),width:a.remap.maskTexture.width,isPot:!1}),ob:a.remap.layers.map(function(h){return a.parent.Xe(h)}),depth:a.remap.depth})},Ef:function(){switch(a.connectivityUp){case "direct":G=Zb.instance(a.connectivity);break;case "square":G=$b.instance(a.connectivity);break;case "squareFast":G=ac.instance(a.connectivity,a.activation);break;case "full":G=
bc.instance(a.connectivity);break;case "conv":v=a.kernelsCount,G=cc.instance(a.connectivity),C&&(d.tb=Y.instance({width:I,isFloat:!0,isFlipY:!1,isPot:!1}))}if(G.Ba){var h=a.size*a.sparsity;y=Math.log(h/a.size)/Math.log(2);d.input=Y.instance({isMipmap:!0,isFloat:!0,isPot:!0,width:h,ic:y});d.bc=Y.instance({isFloat:!0,isPot:!0,width:a.size})}},V:function(h,F){e=h;G.Ba?(d.input.da(),E&&d.Ta.g(2),G.V(x),d.input.g(0),d.input.Me(y),d.bc.da(),E?B.set("s0"):(B.set("s27"),B.H("u25",p),d.Ta.g(1)),d.input.se(y,
0),U.l(!1,!1),B.set(k),z?M.u():d.ba.u(),d.bc.g(0),t&&g.Ie(),U.l(!1,!1)):(d.ba.da(),d.Ta.g(1),G.V());z&&(B.set(J),u.u(),M.g(0),U.l(!1,!1),B.set("s46"),B.H("u6",1),d.ba.u(),u.g(1),U.l(!1,!1));if(l)return H?(d.oc.da(),d.ba.g(0),B.set(N),B.sa("u7",1/a.size,1/a.size),U.l(!1,!1),F=d.oc):F=d.ba,F.g(0),C&&(d.tb.u(),B.set("s21"),B.sa("u12",v,I/v),U.l(!1,!1),F=d.tb,d.tb.g(0)),F;var K=d.ba;a.normalize&&(B.set("gpuRawAvg"===q?"s8":"s7"),B.H("u4",1/a.size),d.pc.da(),d.ba.g(0),U.l(!1,!1),K=d.pc);h=null;switch(q){case "cpuRGBA2Float":K.Zc(!1);
F?h=L.vf(K).then(r):(K=L.wf(K),r(K));break;case "cpuMeanFloat":K.Zc(!0);F?h=K.yf().then(r):(K=K.zf(),r(K));break;case "gpuRawAvg":case "gpuRaw":K.g(0);case "none":null!==r&&r(K)}F&&null===h&&(h=Promise.resolve());return h},Ce:function(h){h&&(q=h.qc||"none",r=h.nc||null);d.ba=Y.instance({isFloat:!0,isPot:!0,isMipmap:!1,width:a.size});h="undefined"!==typeof a.classesCount&&a.classesCount?a.classesCount:a.size*a.size;for(var F=0,K=0,P=0;F<h;++F)m.push(K+(a.size-1-P)*a.size),n.push([-1,-1,-1,-1]),++K,
K===a.size&&(K=0,++P);a.normalize&&(d.pc=Y.instance({isFloat:!0,isPot:!0,width:a.size}))},vf:function(h){return h.xf().then(c)},wf:function(h){h=h.Sd();c(h);return n},m:function(){for(var h in d){var F=d[h];F&&F.remove()}G&&(G.m(),G=null)}};a.vb&&L.Ef(a.vb);return L}}}(),Zb=function(){return{instance:function(a){var c=Y.instance(a.weights);return{Ba:!0,bb:function(){return 1},m:function(){c.remove()},af:function(){return c},V:function(){B.set("s26");c.g(1);U.l(!1,!1)}}}}}(),bc=function(){return{instance:function(a){var c=
a.fromLayerSize,d=Y.instance(a.weights);return{Ba:!0,bb:function(){return c},m:function(){d.remove()},V:function(e){if(e.isEnabled){B.set("s24");e.lf.g(3);var m,n=Math.min(e.ob.length,e.depth);for(m=0;m<n;++m)e.ob[m].re(4+m)}else B.set("s23");B.H("u16",a.toLayerSize);d.g(1);U.l(!1,!1)}}}}}(),$b=function(){return{instance:function(a){for(var c=a.fromLayerSize,d=a.toLayerSize,e=a.toSparsity,m=e*d,n=m/c,q=c/d,r=0,l=0,v=0,C=Array(e*d*e*d*4),E=Array(e*d*e*d*4),g=Array(c*c),t=0;t<g.length;++t)g[t]=0;t=
Math.floor(e/2);for(var x=.5/d,k=.5/c,p=.5/m,H=0;H<d;++H)for(var I=Math.round(H*q),N=0;N<d;++N){var z=Math.round(N*q),J=H/d,M=N/d;J+=x;M+=x;for(var u=0;u<e;++u){var f=I+u-t;0>f&&(f+=c);f>=c&&(f-=c);for(var y=0;y<e;++y){var G=r/m,L=l/m,h=z+y-t;0>h&&(h+=c);h>=c&&(h-=c);var F=f/c,K=h/c;L=1-L-1/m;F+=k;K+=k;G+=p;L+=p;var P=H*e+u,da=N*e+y;da=d*e-da-1;P=da*d*e+P;C[4*P]=G;C[4*P+1]=L;C[4*P+2]=F;C[4*P+3]=K;K=g[h*c+f]++;P=K%n;F=f*n+P;h=h*n+(K-P)/n;h=c*n-1-h;h=h*c*n+F;E[4*h]=G;E[4*h+1]=L;E[4*h+2]=J;E[4*h+3]=
M;++r>=m&&(r=0,++l);++v}}}g=null;var ra=Y.instance(a.weights);delete a.weights.data;var za=Y.instance({width:m,isFloat:!0,array:new Float32Array(E),isPot:!0});E=null;var w=Y.instance({width:m,isFloat:!0,array:new Float32Array(C),isPot:!0});C=null;return{Ba:!0,bb:function(){return n},m:function(){za.remove();w.remove();ra.remove()},V:function(){B.set("s22");ra.g(1);w.g(2);U.l(!1,!1)}}}}}(),cc=function(){return{instance:function(a){var c=a.kernelsCount,d=a.toSparsity,e=d*a.toLayerSize/a.fromLayerSize,
m=Y.instance(a.weights);return{Ba:!0,bb:function(){return e},Wg:function(){return d},af:function(){return m},m:function(){m.remove()},V:function(){B.set("s25");B.H("u22",c);B.H("u23",d);B.H("u16",a.toLayerSize);B.H("u24",a.fromLayerSize);m.g(1);U.l(!1,!1)}}}}}(),ac=function(){return{instance:function(a,c){var d=a.fromLayerSize,e=a.toLayerSize,m=a.toSparsity,n=a.stride?a.stride:1,q=m*e/d,r=e<d,l=d/e,v=Y.instance(a.weights),C="s47"+[d.toString(),e.toString(),m.toString(),n.toString(),c].join("_");B.Ke(C)||
(a=Ub.Ne(c,"gl_FragColor","gl_FragColor"),e=[{type:"1f",name:"u16",value:e},{type:"1f",name:"u29",value:n}],r&&e.push({type:"1f",name:"u24",value:d}),d=[(r?q:m).toFixed(1),a],r&&d.push(l.toFixed(1)),B.sd(r?"s39":"s38",C,d),B.T(C,e.concat([{type:"1i",name:"u14",value:0},{type:"1i",name:"u21",value:1},{type:"1i",name:"u13",value:3}])));return{Ba:!1,bb:function(){return q},m:function(){v.remove()},V:function(){B.set(C);v.g(3);U.l(!1,!1)}}}}}(),Xb=function(){return{instance:function(a){var c=a.Jd?a.Jd:
3,d=a.td?a.td:64,e=a.Nd?a.Nd:64,m=a.lb?!0:!1;a={isFloat:!1,width:d,isPot:!1,isFlipY:!1};var n=Y.instance(a),q=Y.instance(a),r=Y.instance(a),l=Y.instance(a),v=Y.instance({isFloat:!0,width:e,isPot:!1,isFlipY:!1}),C=1/d;return{process:function(E){B.set("s35");l.u();U.l(m,!1);B.set("s36");for(var g=0;g<c;++g)n.u(),B.sa("u7",C,0),U.l(m,!1),r.u(),l.g(0),U.l(m,!1),q.u(),n.g(0),B.sa("u7",0,C),U.l(m,!1),l.u(),r.g(0),U.l(m,!1),g!==c-1&&q.g(0);B.set("s37");v.u();E.g(0);q.g(1);l.g(2);U.l(m,!1);v.g(0)},Xb:function(){return v}}}}}(),
Yb=function(){return{instance:function(a){function c(v){return Y.instance({isFloat:v,width:d.D,isPot:!1,isFlipY:!1})}var d=Object.assign({fe:.1,Sc:9,D:128,lb:!1},a),e=c(!1),m=[c(!1),c(!1),c(!1)],n=[c(!1),c(!1),c(!1)],q=c(!0),r=[e,n[0],n[1]];a="uniform sampler2D u1;const float e=1.1111,g=2.2222;uniform vec2 u31;varying vec2 vv0;void main(){float b=0.,c=0.;for(float a=-e;a<=e;a+=1.){vec2 i=u31*a,j=vv0+i*g;float d=1.2*a/e,f=exp(-d*d);b+=f*texture2D(u1,j).r,c+=f;}b/=c,gl_FragColor=vec4(b,0.,0.,1.);}".replace("1.1111",
Math.round((d.Sc-1)/2).toFixed(2)).replace("2.2222",(1/d.D).toFixed(6));var l={u1:0};B.Qc([{id:"s49",name:"_",h:"uniform sampler2D u1;varying vec2 vv0;const vec3 f=vec3(.2126,.7152,.0722),g=vec3(1.,1.,1.);void main(){vec3 b=texture2D(u1,vv0).rgb;float a=dot(b,f);gl_FragColor=vec4(a,a,a,a);}",j:l,i:["u1"],precision:"lowp"},{id:"s50",name:"_",h:a,j:l,i:["u1","u31"],precision:"lowp"},{id:"s51",name:"_",h:"uniform sampler2D u32,u33,u34,u35;const float f=1.1111;const vec3 g=vec3(1.,1.,1.);varying vec2 vv0;void main(){vec3 a=texture2D(u32,vv0).rgb;float c=texture2D(u33,vv0).r,d=texture2D(u34,vv0).r,h=texture2D(u35,vv0).r,i=a.r*a.r;vec3 b=vec3(c,d,h),j=max(g*f,abs(i-b*b)),k=sqrt(j);gl_FragColor=vec4(a.r,(a-b)/k);}".replace("1.1111",
d.fe.toFixed(4)),j:{u32:0,u33:1,u34:2,u35:3},i:["u32","u33","u34","u35"],precision:"highp"}]);return{process:function(){B.set("s49");e.da();U.l(d.lb,!1);B.set("s50");for(var v=0;3>v;++v)B.sa("u31",1,0),m[v].u(),r[v].g(0),U.l(!1,!1),B.sa("u31",0,1),n[v].u(),m[v].g(0),U.l(!1,!1);B.set("s51");q.u();e.g(0);n[0].g(1);n[1].g(2);n[2].g(3);U.l(!1,!1);q.g(0)},Xb:function(){return q}}}}}(),W={$e:function(){return W.Yc()?document.createElement("video"):!1},La:function(a,c){a[c]=!0;a.setAttribute(c,"true")},
ye:function(){var a=!1,c=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,
4)))a=!0;return a},Vc:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},Oe:function(){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return a&&a.length&&2<a.length?[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]:[0,0,0]},Dd:function(){try{return window.matchMedia("(orientation: portrait)").matches?!0:!1}catch(a){return window.innerHeight>window.innerWidth}},xe:function(){return W.Wc()||W.Vc()},Wc:function(){var a=navigator.userAgent.toLowerCase();
return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")?!0:!1},Ag:function(){return W.ye()?W.Dd()?window.innerHeight/window.innerWidth*45:45:45},Yc:function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?!0:!1},pause:function(a){a.pause()},rh:function(a){a.play()},release:function(a){a.pause();a.videoStream&&a.videoStream.stop();a.videoStream=null},Xc:function(a){if(!a)return a;var c=null;if(a.video){var d=function(e){return e&&"object"===typeof e?Object.assign({},e):e};c={};
"undefined"!==typeof a.video.width&&(c.width=d(a.video.width));"undefined"!==typeof a.video.height&&(c.height=d(a.video.height));"undefined"!==typeof a.video.facingMode&&(c.facingMode=d(a.video.facingMode))}c={audio:a.audio,video:c};"undefined"!==typeof a.deviceId&&W.Oc(c,a.deviceId);return c},Oc:function(a,c){c&&(a.video=a.video||{},a.video.deviceId={exact:c},a.video.facingMode&&delete a.video.facingMode)},ae:function(a){var c=a.video.width;a.video.width=a.video.height;a.video.height=c;return a},
Be:function(a){function c(g){return[480,576,640,648,720,768,800,960,1080,1152,1280,1366,1920].sort(function(t,x){return Math.abs(t-g)-Math.abs(x-g)})}function d(g){var t=W.Xc(a);g=g(t);m.push(g);e(g)}function e(g){if(g.video&&g.video.facingMode&&g.video.facingMode.exact){var t=g.video.facingMode.exact;g=W.Xc(g);delete g.video.facingMode.exact;g.video.facingMode.ideal=t;m.push(g)}}var m=[];if(!a||!a.video)return m;e(a);if(a.video.width&&a.video.height){if(a.video.width.ideal&&a.video.height.ideal){var n=
c(a.video.width.ideal).slice(0,3),q=c(a.video.height.ideal).slice(0,3),r={},l=0;for(r.na=void 0;l<n.length;r={na:r.na},++l){r.na=n[l];var v={},C=0;for(v.ma=void 0;C<q.length;v={ma:v.ma},++C)if(v.ma=q[C],r.na!==a.video.width.ideal||v.ma!==a.video.height.ideal){var E=Math.max(r.na,v.ma)/Math.min(r.na,v.ma);E<4/3-.1||E>16/9+.1||d(function(g,t){return function(x){x.video.width.ideal=g.na;x.video.height.ideal=t.ma;return x}}(r,v))}}}d(function(g){return W.ae(g)})}a.video.width&&a.video.height&&(a.video.width.ideal&&
a.video.height.ideal&&d(function(g){delete g.video.width.ideal;delete g.video.height.ideal;return g}),d(function(g){delete g.video.width;delete g.video.height;return g}));a.video.facingMode&&(d(function(g){delete g.video.facingMode;return g}),a.video.width&&a.video.height&&d(function(g){W.ae(g);delete g.video.facingMode;return g}));m.push({audio:a.audio,video:!0});return m},Lf:function(a){if(W.Dd()){if(!a||!a.video)return!1;var c=a.video.width,d=a.video.height;if(!c||!d)return!1;if(c.ideal&&d.ideal&&
c.ideal>d.ideal)return a.video.height=c,a.video.width=d,!0}return!1},qb:function(a){a.volume=0;W.La(a,"muted");if(W.Wc()){if(1===a.volume){var c=function(){a.volume=0;window.removeEventListener("mousemove",c,!1);window.removeEventListener("touchstart",c,!1)};window.addEventListener("mousemove",c,!1);window.addEventListener("touchstart",c,!1)}setTimeout(function(){a.volume=0;W.La(a,"muted")},5)}},de:function(a,c,d){return null===a?Promise.resolve():new Promise(function(e,m){if(a.srcObject&&a.srcObject.getVideoTracks){var n=
a.srcObject.getVideoTracks();1!==n.length?m("INVALID_TRACKNUMBER"):(n=n[0],c?W.get(a,e,m,d):(n.stop(),e()))}else m("BAD_IMPLEMENTATION")})},qd:function(a,c,d,e){function m(q){n||(n=!0,d(q))}var n=!1;return navigator.mediaDevices.getUserMedia(e).then(function(q){function r(){setTimeout(function(){if(a.currentTime){var v=a.videoWidth,C=a.videoHeight;if(0===v||0===C)m("VIDEO_NULLSIZE");else{v&&(a.style.width=v.toString()+"px");C&&(a.style.height=C.toString()+"px");v={we:null,If:null,mf:null};try{var E=
q.getVideoTracks()[0];E&&(v.mf=E,v.we=E.getCapabilities(),v.If=E.getSettings())}catch(g){}W.xe()?a.parentNode&&null!==a.parentNode?(n||c(a,q,v),setTimeout(function(){a.play()},100)):(document.body.appendChild(a),W.qb(a),n||c(a,q,v),setTimeout(function(){a.style.transform="scale(0.0001,0.0001)";a.style.position="fixed";a.style.bottom="0px";a.style.right="0px";W.qb(a);setTimeout(function(){a.play()},100)},80)):n||c(a,q,v)}}else m("VIDEO_NOTSTARTED")},700)}function l(){a.removeEventListener("loadeddata",
l,!1);var v=a.play();W.qb(a);"undefined"===typeof v?r():v.then(function(){r()}).catch(function(){m("VIDEO_PLAYPROMISEREJECTED")})}"undefined"!==typeof a.srcObject?a.srcObject=q:(a.src=window.URL.createObjectURL(q),a.videoStream=q);W.qb(a);a.addEventListener("loadeddata",l,!1)}).catch(function(q){m(q)})},get:function(a,c,d,e){if(!a)return d&&d("VIDEO_NOTPROVIDED"),!1;if(!W.Yc())return d&&d("MEDIASTREAMAPI_NOTFOUND"),!1;if(e&&e.video){if(W.Vc()){var m=W.Oe();0!==m[0]&&(12>m[0]||12===m[0]&&2>m[1])&&
W.Lf(e)}e.video.width&&e.video.width.ideal&&(a.style.width=e.video.width.ideal+"px");e.video.height&&e.video.height.ideal&&(a.style.height=e.video.height.ideal+"px")}W.La(a,"autoplay");W.La(a,"playsinline");e&&e.audio?a.volume=0:W.La(a,"muted");W.qd(a,c,function(){function n(r){if(0===r.length)d("INVALID_FALLBACKCONSTRAINTS");else{var l=r.shift();W.qd(a,c,function(){n(r)},l)}}var q=W.Be(e);n(q)},e)},Ze:function(a){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a(!1,"NOTSUPPORTED"),
!1;navigator.mediaDevices.enumerateDevices().then(function(c){(c=c.filter(function(d){return d.kind&&-1!==d.kind.toLowerCase().indexOf("video")&&d.label&&d.deviceId}))&&c.length&&0<c.length?a(c,!1):a(!1,"NODEVICESFOUND")}).catch(function(){a(!1,"PROMISEREJECTED")})},cg:function(a,c,d){var e={};e[c]=d;c=[];c.push(e);a.applyConstraints({advanced:c}).catch(function(){})}},pa=function(){function a(t,x,k,p,H,I){if(I===H.length)p();else{switch(H[I]){case "D":t();break;case "S":x().then(function(){g.be();
a(t,x,k,p,H,++I)}).catch(p);return;case "R":k()}a(t,x,k,p,H,++I)}}var c={n:5,kc:1,Gd:0,ab:[35,49],Xa:[2,200],k:.7,Qf:200,tf:.05},d=-1,e=null,m=-1,n=-1,q=0,r=-1,l=-1,v=0,C=0,E=c.Xa[1],g={od:function(){switch(d){case -1:return-1;case 0:return l+e.Gd;case 1:return v}},Fg:function(t){return Math.pow(Math.min(Math.max(r,0),e.n-1)/(e.n-1),t||1)},A:function(t){e=Object.assign({},c,t);r=l=e.kc;d=0;g.reset()},be:function(t){t=("undefined"===typeof t?Date.now():t)||0;var x=Math.min(Math.max(t-C,e.Xa[0]),e.Xa[1]);
E=x;C=t;var k=-1===m?0:e.k;m=Math.min(Math.max(1E3/x,5),120)*(1-k)+m*k;t-n>e.Qf&&5<++q&&(x=e.k,r=r*(1-x)+(m<e.ab[0]?l-1:m>e.ab[1]?l+1:l)*x,Math.abs(r-l)>1-e.tf&&(x=Math.min(Math.max(Math.round(r),0),e.n-1),x!==l&&(r=l=x,m=(e.ab[1]-e.ab[0])/2)),n=t)},rc:function(t,x,k,p,H){a(t,x,k,p,H,0)},vc:function(t){v=t;d=1},Gc:function(){d=0;g.reset()},reset:function(){E=c.Xa[1];n=m=-1;q=0},Re:function(){return E}};return g}(),Ma=function(){function a(){d(k+t.jc);p.port.postMessage("DONE")}function c(){var f=
t.ga;z.isEnabled&&(f=Math.max(f,z.ga));N.Ra=0===f?window.requestAnimationFrame(d):window.requestAnimationFrame(e)}function d(f){I.ya&&null!==x&&(f-=k,f=Math.min(Math.max(f,t.$c[0]),t.$c[1]),k+=f,n(),z.isEnabled&&z.Y&&I.Z&&k-z.fc>t.Lc&&(v(),z.fc=k),x(k))}function e(f){I.ya&&(N.timeout=window.setTimeout(d.bind(null,f),t.ga))}function m(){x=null;I.ya=!1;n()}function n(){N.Ra&&(window.cancelAnimationFrame(N.Ra),N.Ra=null);N.timeout&&(window.clearTimeout(N.timeout),N.timeout=null)}function q(f){f&&!I.Z?
(I.Z=!0,H&&pa.Gc(),p.port.postMessage("STOP"),ba.ce(!0),c()):!f&&I.Z&&(I.Z=!1,H&&pa.vc(1),ba.ce(!1),p.port.postMessage("START"))}function r(f){f.target.hidden?M():J()}function l(f,y,G){y=f.createShader(y);f.shaderSource(y,G);f.compileShader(y);return y}function v(){z.Y=!1;var f=z.eb,y=z.fb,G=z.gb,L=z.X;f.uniform1f(z.rd,Math.random());z.za?y.beginQueryEXT(L,G):f.beginQuery(L,G);f.drawElements(f.POINTS,1,f.UNSIGNED_SHORT,0);z.za?y.endQueryEXT(L):f.endQuery(L);f.flush();E().then(function(h){h=t.he*t.Jc*
1E3/h;z.Db=(z.Db+1)%t.Da;z.hc[z.Db]=h;if(++z.Ed>t.Da){z.nb.set(z.hc);z.nb.sort();h=z.nb[Math.floor(t.Da/2)];z.Za=Math.max(z.Za,h);var F;for(F=0;F<z.Ec&&!(h>z.Za*(1-(t.Kc[F]+t.ie*(F>=z.Bb?1:-1))));++F)F===z.Ec-1&&++F;F!==z.Bb&&(console.log("THERMAL THROTTLING LEVEL = "+F.toString()),z.Bb=F,z.ga=0===F?0:t.ge[F-1],t.Ic&&t.Ic(F))}z.Y=!0}).catch(function(){z.Y=!0})}function C(f){var y=z.eb,G=z.fb,L=z.gb;L=z.za?G.Cg(L,G.QUERY_RESULT_AVAILABLE_EXT):y.getQueryParameter(L,y.QUERY_RESULT_AVAILABLE);y=y.getParameter(G.GPU_DISJOINT_EXT);
L?f(!y):setTimeout(C.bind(null,f),.1)}function E(){return new Promise(function(f,y){C(function(G){if(G){G=z.eb;var L=z.fb,h=z.gb;G=z.za?L.getQueryObjectEXT(h,L.QUERY_RESULT_EXT):G.getQueryParameter(h,G.QUERY_RESULT);f(G)}else y()})})}var g={zd:!0,$c:[1,200],jc:20,ga:0,je:!1,Jc:50,he:240,Lc:3E3,Da:3,Kc:[.2,.35,.5],ie:.05,ge:[8,20,40],Ic:null},t=null,x=null,k=0,p=null,H=!1,I={qa:!1,Z:!0,ec:!1,dc:!1,cc:!1,ya:!1},N={Ra:null,timeout:null},z={isEnabled:!1,Y:!1,eb:null,fb:null,gb:null,X:null,rd:null,za:!0,
Bb:0,Ec:0,ga:0,fc:0,Ed:0,hc:null,nb:null,Db:0,Za:0},J=q.bind(null,!0),M=q.bind(null,!1),u={A:function(f){t=Object.assign(g,f);Object.assign(I,{Z:!0,qa:!0,ya:!1});if(t.je){f=document.createElement("canvas");f.setAttribute("width","1");f.setAttribute("height","1");var y={antialias:!1};f=f.getContext("webgl2",y)||f.getContext("webgl",y);if(y=f.getExtension("EXT_disjoint_timer_query")||f.getExtension("EXT_disjoint_timer_query_webgl2")){z.eb=f;z.fb=y;z.isEnabled=!0;z.za=y.beginQueryEXT?!0:!1;var G=l(f,
f.VERTEX_SHADER,"attribute vec4 a0;void main(){gl_Position=a0;}"),L=l(f,f.FRAGMENT_SHADER,"precision lowp float;uniform float u36;void main(){vec4 a=u36*vec4(1.,2.,3.,4.);for(int b=0;b<666;b+=1)a=cos(a);gl_FragColor=a;}".replace("666",t.Jc.toString())),h=f.createProgram();f.attachShader(h,G);f.attachShader(h,L);f.linkProgram(h);G=f.getAttribLocation(h,"a0");z.rd=f.getUniformLocation(h,"u36");f.useProgram(h);f.enableVertexAttribArray(G);h=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,h);f.bufferData(f.ARRAY_BUFFER,
new Float32Array([.5,.5,0,1]),f.STATIC_DRAW);f.vertexAttribPointer(G,4,f.FLOAT,!1,16,0);h=f.createBuffer();f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,h);f.bufferData(f.ELEMENT_ARRAY_BUFFER,new Uint16Array([0]),f.STATIC_DRAW);f.disable(f.DEPTH_TEST);f.disable(f.DITHER);f.disable(f.STENCIL_TEST);f.viewport(0,0,1,1);h=z.za?y.createQueryEXT():f.createQuery();z.gb=h;z.X=y.TIME_ELAPSED_EXT||f.TIME_ELAPSED;z.Bb=0;z.Ec=t.Kc.length;z.ga=0;z.fc=-t.Lc;z.hc=new Float32Array(t.Da);z.nb=new Float32Array(t.Da);z.Za=0;
z.Db=0;z.Ed=0;z.Y=!0}}if(t.zd){f=!1;try{if("undefined"===typeof SharedWorker){var F=URL.createObjectURL(new Blob(["let handler = null;\n      self.addEventListener('message', function(e){\n        if (handler !== null){\n          clearTimeout(handler);\n          handler = null;\n        }\n        switch (e.data) {\n          case 'START':\n          case 'DONE':\n            handler = setTimeout(function(){\n              self.postMessage('TICK');\n            }, "+t.jc.toString()+");\n            break;\n          case 'STOP':\n            break;\n        };\n      }, false);"],
{type:"text/javascript"})),K=new Worker(F);K.addEventListener("message",a);p={Qd:K,port:K};I.ec=!0}else{var P=URL.createObjectURL(new Blob(["let handler = null;\n      onconnect = function(e) {\n        const port = e.ports[0];\n        port.addEventListener('message', function(e) {\n          \n          if (handler !== null){\n            clearTimeout(handler);\n            handler = null;\n          }\n          switch (e.data) {\n            case 'START':\n            case 'DONE':\n              handler = setTimeout(function(){\n                port.postMessage('TICK');\n              }, "+
t.jc.toString()+");\n              break;\n            case 'STOP':\n              break;\n          };\n          \n        });\n        \n        port.start();\n      } // end onconnect()"],{type:"text/javascript"})),da=new SharedWorker(P);da.port.start();da.port.addEventListener("message",a);p={Qd:da,port:da.port};I.dc=!0}f=!0}catch(ra){}f&&("onvisibilitychange"in document?document.addEventListener("visibilitychange",r):(window.addEventListener("blur",M),window.addEventListener("focus",J)),I.cc=
!0)}H="undefined"!==typeof pa},m:function(){m();I.cc&&("onvisibilitychange"in document?document.removeEventListener("visibilitychange",r):(window.removeEventListener("blur",M),window.removeEventListener("focus",J)),I.cc=!1);I.dc?(p.port.close(),I.dc=!1):I.ec&&(p.Qd.terminate(),I.ec=!1);Object.assign(I,{Z:!0,qa:!1,ya:!1});x=null},hh:function(){return I.Z},update:function(f){Object.assign(t,f)},rc:function(f){I.qa||u.A({});n();I.ya=!0;x=f;I.Z&&c()},stop:m};return u}(),tb=function(){var a={Ld:4,ub:[1.5,
1.5,2],O:[.1,.1,.1],Ud:1,D:-1,M:-1,Kf:2,sf:1,Vd:!0,Je:.8},c=null,d=[],e=0,m=[.5,.5,1];return{A:function(n){c=Object.assign({},a,n);d.splice(0);n=c.ub[0]*c.O[0];var q=c.ub[1]*c.O[1],r=1/(1+c.ub[2]*c.O[2]),l=c.Ud*Math.min(c.D,c.M),v=l/c.D;l/=c.M;var C=.5*c.Je;C*=C;for(var E=0;E<c.Ld;++E){var g=Math.pow(r,E),t=v*g,x=l*g;g=t*n;var k=x*q,p=t/2;x/=2;for(var H=1+(1-p-p)/g,I=1+(1-x-x)/k,N=0;N<I;++N)for(var z=x+N*k,J=z-.5,M=0;M<H;++M){var u=p+M*g,f=u-.5;f*f+J*J>C||d.push([u,z,t*c.sf])}}c.Vd&&d.sort(function(y,
G){var L=y[0]-.5;y=y[1]-.5;var h=G[0]-.5;G=G[1]-.5;return L*L+y*y-(h*h+G*G)})},get:function(){var n=d.length;if(0===n)return m;e>=n&&(e=0);var q=d[Math.floor(e)];e=(e+1/c.Kf)%n;return q}}}(),aa={neuralNetworkPath:"NN_DEFAULT.json",fa:0,Eb:[2,7],Af:{threshold:1,nScaleLevels:2,scale0Factor:.8,overlapFactors:[2,2,3],scanCenterFirst:!0,nDetectsPerLoop:-1,isCleanGLStateAtEachIteration:!0,animateProcessOrder:"DSR"},Nf:50,Id:.5,Hd:.4,pf:8,Jf:{translationFactorRange:[.0015,
.005],rotationFactorRange:[.003,.02],qualityFactorRange:[.9,.98],alphaRange:[.05,1],followZRotAlphaFactor:.2},Oa:[.65,1,.262],O:[.092,.092,.3],le:.2,oe:2,me:.1,qf:8,Kd:1,Le:Za.pb.bind(null,.3,.7),Tf:20,Zd:3},oa={facingMode:"user",idealWidth:800,idealHeight:600,minWidth:480,maxWidth:1920,minHeight:480,maxHeight:1920,rotate:0,flipX:!1},ha={lc:-3,kf:-1,error:-2,ready:1,play:2,pause:3},na=ha.lc,A=null,dc={jb:!1,zc:null,element:null,N:null,G:[0,0],L:[.5,.5],v:[.5,0,0,.5],wb:0,Ka:null,ib:!1},Q=null,ec=
{Ja:null,Ua:null,antialias:!0,Mc:"./",Ea:null,ia:null,fa:aa.fa,Pd:aa.fa,kb:!1,ua:!0},Oa=null,ja=null,sa=null,Pa=1,Na={uc:-1,Mb:-1},Z=null,fc={D:0,M:0,G:[0,0],xa:null},X={Ca:null,buffer:null,O:null,Oa:null,aa:aa.Kd,Ma:null},Sa=null,qa=null,O={o:1,pa:0,W:null,Ad:!1,Fd:0,mc:0},hb=[],ib=[],Eb={VERSION:"2.1.6",init:function(a){function c(){na!==ha.error&&2===++e&&(Ja(),xb(),Ia(),Q.Ja&&(na=ha.ready,Q.Ja(!1,{GL:b,canvasElement:Q.ia,videoTexture:A.N.get(),videoTransformMat2:A.v,maxFacesDetected:O.o,videoElement:A.element}),
fb()),eb())}if(na!==ha.lc)return a.callbackReady&&a.callbackReady("ALREADY_INITIALIZED"),!1;na=ha.kf;A=Object.assign({},dc);Q=Object.assign({},ec);Z=Object.assign({},fc);O.W=[0];X.O=aa.O.slice(0);X.Oa=aa.Oa.slice(0);"undefined"!==typeof a.antialias&&(Q.antialias=a.antialias);a.callbackReady&&(Q.Ja=a.callbackReady);a.callbackTrack&&(Q.Ua=a.callbackTrack);a.nExpressions&&(X.aa=a.nExpressions);a.expressionsEasings&&(X.Ma=a.expressionsEasings);"undefined"!==typeof a.animateDelay&&(Q.fa=a.animateDelay);
"undefined"!==typeof a.NNCPath&&(Q.Mc=a.NNCPath);"undefined"!==typeof a.NNC&&(Q.Ea=a.NNC);"undefined"!==typeof a.maxFacesDetected&&(O.o=Math.max(1,a.maxFacesDetected));"undefined"!==typeof a.followZRot&&(Q.ua=a.followZRot?!0:!1);if(O.o>aa.pf)return Ha("MAXFACES_TOOHIGH"),!1;if(!a.canvasId&&!a.canvas)return Ha("NO_CANVASID"),!1;Q.ia=a.canvas?a.canvas:document.getElementById(a.canvasId);if(!Q.ia)return Ha("INVALID_CANVASID"),!1;Z.D=Q.ia.width;Z.M=Q.ia.height;if(!Z.D||!Z.M)return Ha("INVALID_CANVASDIMENSIONS"),
!1;for(var d=0;d<O.o;++d)hb.push(new Float32Array(aa.qf)),ib.push(0);Ma.A({zd:a.isKeepRunningOnWinFocusLost||!1,ga:Q.fa});pa.A({kc:0,n:aa.Eb[1]-aa.Eb[0]+1,Gd:aa.Eb[0]});ja=Object.create(aa.Af);a.scanSettings&&(Object.assign(ja,a.scanSettings),-1!==ja.nDetectsPerLoop?pa.vc(ja.nDetectsPerLoop):pa.Gc());sa=Object.create(aa.Jf);a.stabilizationSettings&&Object.assign(sa,a.stabilizationSettings);var e=0;a.videoSettings&&a.videoSettings.videoElement?$a(a.videoSettings.videoElement,c):(a.videoSettings&&Object.assign(oa,
a.videoSettings),zb(a.onWebcamAsk,a.onWebcamGet,function(m){$a(m,c)}));Pb(function(m){if(!Qb())return!1;Oa=new Fb({ob:m.layers,qc:"gpuRawAvg",nc:Sb});B.Qc([{id:"s53",name:"_",ta:"attribute vec2 a0;uniform mat2 u37;varying vec2 vv0;void main(){gl_Position=vec4(a0,0.,1.),vv0=vec2(.5,.5)+u37*a0;}",Sa:["a0"],Ga:[2],h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",i:["u1","u37"],precision:"lowp"},{id:"s54",name:"_",h:"uniform sampler2D u1;varying vec2 vv0;void main(){gl_FragColor=texture2D(u1,vv0);}",
ta:"attribute vec2 a0;uniform sampler2D u38;uniform mat2 u37;uniform vec2 u39;uniform float u40,u41,u42;varying vec2 vv0;void main(){vec4 a=texture2D(u38,vec2(.17,u40));vec2 f=a.gb,g=a.a*u39,b=a0;b.x*=u42;float c=cos(u41),d=sin(u41);vec2 h=mat2(c,d,-d,c)*b,i=f+h*.5*g,j=i-.5;vv0=.5+2.*u37*j,gl_Position=vec4(a0,0.,1.);}",Sa:["a0"],Ga:[2],i:"u1 u38 u39 u40 u41 u42 u37".split(" "),precision:"lowp"},{id:"s55",name:"_",h:"uniform sampler2D u43,u38;uniform vec3 u44,u45;uniform float u46,u47,u40,u48,u41,u49;const vec4 e=vec4(.25,.25,.25,.25);void main(){vec4 d=texture2D(u43,vec2(.625,.625)),f=texture2D(u43,vec2(.875,.625)),a=texture2D(u38,vec2(.17,u40));float g=dot(d-f,e);bool h=g>u47;h?a.r=2.:a.r>u46?a.r=0.:a.r>1.9?a.r+=1.:0.,a.r*=u48;if(a.r<.9)a=vec4(1.,u44);else{a.r*=step(1.9,a.r);float i=dot(e,texture2D(u43,vec2(.875,.875))),j=dot(e,texture2D(u43,vec2(.125,.625))),k=dot(e,texture2D(u43,vec2(.375,.625))),b=cos(u41),c=sin(u41);vec2 l=mat2(b,c*u49,-c/u49,b)*vec2(i,j);a.gba+=vec3(l,k)*u45*a.a;}gl_FragColor=a;}",
ta:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",i:"u43 u38 u44 u46 u45 u48 u41 u49 u47 u40".split(" ")},{id:"s56",name:"_",ta:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",h:"uniform sampler2D u43;const vec4 e=vec4(.25,.25,.25,.25);const vec3 f=vec3(.5,.5,.5);void main(){float a=dot(e,texture2D(u43,vec2(.125,.875))),b=dot(e,texture2D(u43,vec2(.375,.875))),c=dot(e,texture2D(u43,vec2(.625,.875))),d=dot(e,texture2D(u43,vec2(.625,.625)));vec3 g=vec3(a,b,c)*.5+f;gl_FragColor=vec4(g,d);}",
i:["u43"]},{id:"s57",name:"_",ta:"attribute vec2 a0;void main(){gl_Position=vec4(a0,0.,1.);}",h:"uniform sampler2D u43;const vec4 e=vec4(.25,.25,.25,.25);void main(){float a=dot(e,texture2D(u43,vec2(.375,.375))),b=dot(e,texture2D(u43,vec2(.625,.375))),c=dot(e,texture2D(u43,vec2(.875,.375))),d=dot(e,texture2D(u43,vec2(.125,.125)));gl_FragColor=vec4(a,b,c,d);}",i:["u43"]},{id:"s52",name:"_",h:"uniform sampler2D u38;uniform vec2 u50;uniform float u51;varying vec2 vv0;void main(){float f=step(.5,mod(gl_FragCoord.y+1.5,2.)),c=step(.33,vv0.x);vec4 a=texture2D(u38,vv0+u50);a.a=mix(a.a*u51,a.a,c);vec4 d=floor(255.*a),g=255.*(255.*a-d),b=mix(d,g,f)/255.;b.x=mix(step(a.x,1.5),b.x,c),gl_FragColor=b;}",
i:["u38","u51","u50"]}]);sb();Ob();kb();jb();c()});return!0},destroy:function(){Ma.m();return new Promise(function(a){Eb.toggle_pause(!0,!0).finally(function(){Oa&&Oa.m();Qa.m();Oa=qa=Sa=null;hb.splice(0);ib.splice(0);Z.xa=null;X.Ca=null;A.N=null;na=ha.lc;a()}).catch(function(){})})},toggle_pause:function(a,c){if(!Ya())return Promise.reject("NOT_READY");var d=null;d=A.ib?Promise.resolve():c?W.de(A.element,!a,A.Ka):Promise.resolve();a?rb():d.then(function(){eb()});return d},update_videoSettings:function(a){rb();
return new Promise(function(c,d){W.de(A.element,!1,A.Ka).then(function(){Object.assign(oa,a);zb(null,null,function(e){$a(e,function(){Ja();Ia();eb();c()})})}).catch(d)})},toggle_slow:function(a){Ya()&&na===ha.play&&(a&&!Q.kb?(Q.Pd=Q.fa,ja.nDetectsPerLoop=1,this.set_animateDelay(aa.Vf),Q.kb=!0):!a&&Q.kb&&(ja.nDetectsPerLoop=-1,this.set_animateDelay(Q.Pd),Q.kb=!1))},set_animateDelay:function(a){Q.fa=a;Ma.update({ga:Q.fa})},resize:function(){if(!Ya())return!1;var a=Q.ia.width,c=Q.ia.height;if(!lb()&&
a===Z.D&&c===Z.M)return!1;Z.D=a;Z.M=c;B.R();kb();jb();Ja();Ia();return!0},set_inputTexture:function(a,c,d){A.G[0]=c;A.G[1]=d;A.N=Y.instance({width:c,height:d,Zb:a});A.jb=!0;Ja();fb();Ia()},reset_GLState:function(){fb();Z.xa.remove();X.Ca.remove();sb()},render_video:function(){va.P();B.set("s53");b.viewport(0,0,Z.D,Z.M);A.N.g(0);U.l(!0,!0)},reset_inputTexture:function(){A.jb=!1;A.N=A.zc;lb();Ja();Ia()},get_videoDevices:function(a){return W.Ze(a)},set_scanSettings:function(a){Object.assign(ja,a);-1!==
ja.nDetectsPerLoop?pa.vc(ja.nDetectsPerLoop):pa.Gc();kb();jb()},set_stabilizationSettings:function(a){Object.assign(sa,a)},set_videoOrientation:function(a,c){Ya()&&(oa.flipX=c,oa.rotate=a,Ja(),Ia())},update_videoElement:function(a,c){$a(a?a:A.element,function(){xb();Ja();Ia();c&&c()})},create_new:function(){return window.JEELIZFACEFILTERGEN()}};return Eb};window.JEELIZFACEFILTER=window.JEELIZFACEFILTERGEN();
if(typeof(module)!=='undefined'){module.exports=window.JEELIZFACEFILTER;}
window.JEELIZFACEFILTER.FAKEDOM=FAKEDOM;